<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ELK Stack | 小朱杂记</title>
    <meta name="description" content="My Document">
    <link rel="preload stylesheet" href="/charles-blog/assets/style.ae2285a1.css" as="style">
    <script type="module" src="/charles-blog/assets/app.5e5364b8.js"></script>
    <link rel="preload" href="/charles-blog/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
  <link rel="modulepreload" href="/charles-blog/assets/chunks/framework.981adca9.js">
  <link rel="modulepreload" href="/charles-blog/assets/chunks/theme.9ec49980.js">
  <link rel="modulepreload" href="/charles-blog/assets/chunks/ArticleMetadata.8b6b367a.js">
  <link rel="modulepreload" href="/charles-blog/assets/md_database_ElkStack.md.ca5582c6.lean.js">
  <link rel="icon" href="/charles-blog/favicon.ico">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-fc105c82><!--[--><!--]--><!--[--><span tabindex="-1" data-v-827f7975></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-827f7975> Skip to content </a><!--]--><!----><header class="VPNav" data-v-fc105c82 data-v-4765fb17><div class="VPNavBar has-sidebar" data-v-4765fb17 data-v-c560f0cd><div class="container" data-v-c560f0cd><div class="title" data-v-c560f0cd><div class="VPNavBarTitle has-sidebar" data-v-c560f0cd data-v-ebec4beb><a class="title" href="/charles-blog/" data-v-ebec4beb><!--[--><!--]--><!----><!--[-->小朱杂记<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-c560f0cd><div class="curtain" data-v-c560f0cd></div><div class="content-body" data-v-c560f0cd><!--[--><!--]--><div class="VPNavBarSearch search" style="--vp-meta-key:&#39;Meta&#39;;" data-v-c560f0cd><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-c560f0cd data-v-8a05be25><span id="main-nav-aria-label" class="visually-hidden" data-v-8a05be25>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/charles-blog/md/java/" tabindex="0" data-v-8a05be25 data-v-f5f69d10 data-v-a8e5736d><!--[-->Java<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/charles-blog/md/database/" tabindex="0" data-v-8a05be25 data-v-f5f69d10 data-v-a8e5736d><!--[-->数据库<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/charles-blog/md/middleware/" tabindex="0" data-v-8a05be25 data-v-f5f69d10 data-v-a8e5736d><!--[-->中间件<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/charles-blog/md/network/" tabindex="0" data-v-8a05be25 data-v-f5f69d10 data-v-a8e5736d><!--[-->网络<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/charles-blog/md/environment/" tabindex="0" data-v-8a05be25 data-v-f5f69d10 data-v-a8e5736d><!--[-->环境<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/charles-blog/md/distributed/" tabindex="0" data-v-8a05be25 data-v-f5f69d10 data-v-a8e5736d><!--[-->分布式<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/charles-blog/md/about/" tabindex="0" data-v-8a05be25 data-v-f5f69d10 data-v-a8e5736d><!--[-->关于我<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-c560f0cd data-v-7489216d><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-7489216d data-v-c852f474 data-v-43044c5b><span class="check" data-v-43044c5b><span class="icon" data-v-43044c5b><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-c852f474><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-c852f474><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-c560f0cd data-v-46915da0 data-v-5e7b6306><!--[--><a class="VPSocialLink" href="https://github.com/CharleZhuJJ/charles-blog" aria-label="github" target="_blank" rel="noopener" data-v-5e7b6306 data-v-5124df20><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-c560f0cd data-v-0f46c100 data-v-fa61944e><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-fa61944e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-fa61944e><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-fa61944e><div class="VPMenu" data-v-fa61944e data-v-4eba600d><!----><!--[--><!--[--><!----><div class="group" data-v-0f46c100><div class="item appearance" data-v-0f46c100><p class="label" data-v-0f46c100>切换日光/暗黑模式</p><div class="appearance-action" data-v-0f46c100><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-0f46c100 data-v-c852f474 data-v-43044c5b><span class="check" data-v-43044c5b><span class="icon" data-v-43044c5b><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-c852f474><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-c852f474><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-0f46c100><div class="item social-links" data-v-0f46c100><div class="VPSocialLinks social-links-list" data-v-0f46c100 data-v-5e7b6306><!--[--><a class="VPSocialLink" href="https://github.com/CharleZhuJJ/charles-blog" aria-label="github" target="_blank" rel="noopener" data-v-5e7b6306 data-v-5124df20><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-c560f0cd data-v-05cc2436><span class="container" data-v-05cc2436><span class="top" data-v-05cc2436></span><span class="middle" data-v-05cc2436></span><span class="bottom" data-v-05cc2436></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-fc105c82 data-v-c9d1ee7c><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-c9d1ee7c><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-c9d1ee7c><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-c9d1ee7c>文章</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-c9d1ee7c data-v-43a3820c><button data-v-43a3820c>返回顶部</button><!----></div></div><aside class="VPSidebar" data-v-fc105c82 data-v-def99251><div class="curtain" data-v-def99251></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-def99251><span class="visually-hidden" id="sidebar-aria-label" data-v-def99251> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-def99251><section class="VPSidebarItem level-0 is-link has-active" data-v-def99251 data-v-94aa024f><div class="item" tabindex="0" data-v-94aa024f><div class="indicator" data-v-94aa024f></div><a class="VPLink link link" href="/charles-blog/md/database/" data-v-94aa024f data-v-a8e5736d><!--[--><h2 class="text" data-v-94aa024f>数据库</h2><!--]--><!----></a><!----></div><div class="items" data-v-94aa024f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-94aa024f data-v-94aa024f><div class="item" data-v-94aa024f><div class="indicator" data-v-94aa024f></div><a class="VPLink link link" href="/charles-blog/md/database/Mysql.html" data-v-94aa024f data-v-a8e5736d><!--[--><p class="text" data-v-94aa024f>MySQL</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-94aa024f data-v-94aa024f><div class="item" data-v-94aa024f><div class="indicator" data-v-94aa024f></div><a class="VPLink link link" href="/charles-blog/md/database/Oracle.html" data-v-94aa024f data-v-a8e5736d><!--[--><p class="text" data-v-94aa024f>Oracle</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-94aa024f data-v-94aa024f><div class="item" data-v-94aa024f><div class="indicator" data-v-94aa024f></div><a class="VPLink link link" href="/charles-blog/md/database/Redis.html" data-v-94aa024f data-v-a8e5736d><!--[--><p class="text" data-v-94aa024f>Redis</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link is-active has-active" data-v-94aa024f data-v-94aa024f><div class="item" data-v-94aa024f><div class="indicator" data-v-94aa024f></div><a class="VPLink link link" href="/charles-blog/md/database/ElkStack.html" data-v-94aa024f data-v-a8e5736d><!--[--><p class="text" data-v-94aa024f>ELK Stack</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-94aa024f data-v-94aa024f><div class="item" data-v-94aa024f><div class="indicator" data-v-94aa024f></div><a class="VPLink link link" href="/charles-blog/md/database/MongoDB.html" data-v-94aa024f data-v-a8e5736d><!--[--><p class="text" data-v-94aa024f>MongoDB</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-94aa024f data-v-94aa024f><div class="item" data-v-94aa024f><div class="indicator" data-v-94aa024f></div><a class="VPLink link link" href="/charles-blog/md/database/Cache.html" data-v-94aa024f data-v-a8e5736d><!--[--><p class="text" data-v-94aa024f>缓存</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-fc105c82 data-v-6c89610d><div class="VPDoc has-sidebar has-aside" data-v-6c89610d data-v-462c643b><!--[--><!--]--><div class="container" data-v-462c643b><div class="aside" data-v-462c643b><div class="aside-curtain" data-v-462c643b></div><div class="aside-container" data-v-462c643b><div class="aside-content" data-v-462c643b><div class="VPDocAside" data-v-462c643b data-v-eda16060><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-eda16060 data-v-5a905545><div class="content" data-v-5a905545><div class="outline-marker" data-v-5a905545></div><div class="outline-title" data-v-5a905545>目录</div><nav aria-labelledby="doc-outline-aria-label" data-v-5a905545><span class="visually-hidden" id="doc-outline-aria-label" data-v-5a905545> Table of Contents for current page </span><ul class="root" data-v-5a905545 data-v-ce114d19><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-eda16060></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-462c643b><div class="content-container" data-v-462c643b><!--[--><!--]--><!----><main class="main" data-v-462c643b><div style="position:relative;" class="vp-doc _charles-blog_md_database_ElkStack" data-v-462c643b><div><h1 id="elk-stack" tabindex="-1">ELK Stack <span class="VPBadge warning" data-v-b4e454e3><!--[-->持续更新<!--]--></span> <a class="header-anchor" href="#elk-stack" aria-label="Permalink to &quot;ELK Stack &lt;Badge text=&quot;持续更新&quot; type=&quot;warning&quot; /&gt;&quot;">​</a></h1><!----><p>  The Elastic Stack, 包括 Elasticsearch、Kibana、Beats 和 Logstash（也称为 ELK Stack）。能够安全可靠地获取任何来源、任何格式的数据，然后实时地对数据进行搜索、分析和可视化。Elaticsearch，简称为 ES， ES 是一个开源的高扩展的分布式全文搜索引擎，是整个 ElasticStack 技术栈的核心。它可以近乎实时的存储、检索数据；本身扩展性很好，可以扩展到上百台服务器，处理 PB 级别的数据。 <img src="/charles-blog/assets/ElkStack.ad4bbc82.png" alt="ElkStack"></p><ul><li>Elasticsearch <ul><li>Elasticsearch 基于java，基于Lucene，是个开源分布式搜索引擎，它的特点有：分布式，零配置，自动发现，索引自动分片，索引副本机制，restful风格接口，多数据源，自动搜索负载，近实时搜索等。</li></ul></li><li>Logstash <ul><li>Logstash 基于java，是一个开源的用于收集,分析和存储日志的工具。（数据抽取转化工具）一般工作方式为c/s架构，client端安装在需要收集信息的主机上，server端负责将收到的各节点日志进行过滤、修改等操作在一并发往elasticsearch或其他组件上去。</li></ul></li><li>Kibana <ul><li>Kibana 基于nodejs，也是一个开源和免费的工具，Kibana可以为 Logstash 和 ElasticSearch 提供的日志分析友好的Web 界面，可以汇总、分析和搜索重要数据日志。</li></ul></li><li>Beats <ul><li>Beats是elastic公司开源的一款采集系统监控数据的代理agent，是在被监控服务器上以客户端形式运行的数据收集器的统称，可以直接把数据发送给Elasticsearch或者通过Logstash发送给Elasticsearch，然后进行后续的数据分析活动。</li><li>Beats由如下组成: <ul><li>Packetbeat：是一个网络数据包分析器，用于监控、收集网络流量信息，Packetbeat嗅探服务器之间的流量，解析应用层协议，并关联到消息的处理，其支 持ICMP (v4 and v6)、DNS、HTTP、Mysql、PostgreSQL、Redis、MongoDB、Memcache等协议；</li><li>Filebeat：用于监控、收集服务器日志文件，其已取代 logstash forwarder；</li><li>Metricbeat：可定期获取外部系统的监控指标信息，其可以监控、收集 Apache、HAProxy、MongoDB、MySQL、Nginx、PostgreSQL、Redis、System、Zookeeper等服务；</li><li>Winlogbeat：用于监控、收集Windows系统的日志信息；</li><li>Auditbeat：轻量型审计日志采集器。收集您 Linux 审计框架的数据，监控文件完整性。</li><li>Heartbeat：面向运行状态监测的轻量型采集器。通过主动探测来监测服务的可用性。通过给定 URL 列表，Heartbeat 仅仅询问：网站运行正常吗？Heartbeat 会将此信息和响应时间发送至 Elastic 的其他部分，以进行进一步分析。</li><li>Functionbeat：面向云端数据的无服务器采集器。在作为一项功能部署在云服务提供商的功能即服务 (FaaS) 平台上后，Functionbeat 即能收集、传送并监测来自您的云服务的相关数据。</li></ul></li></ul></li></ul><h2 id="elasticsearch" tabindex="-1">Elasticsearch <a class="header-anchor" href="#elasticsearch" aria-label="Permalink to &quot;Elasticsearch&quot;">​</a></h2><p>  Elasticsearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java语言开发的，并作为Apache许可条款下的开放源码发布，是一种流行的企业级搜索引擎。</p><p>  Elasticsearch数据格式：ES 里的 Index 可以看做一个库，而 Types 相当于表，Documents 则相当于表的行。这里 Types 的概念已经被逐渐弱化，Elasticsearch 6.X 中，一个 index 下已经只能包含一个type。 <img src="/charles-blog/assets/EsDataType.dc628ddf.png" alt="EsDataType"></p><p>  ElasticSearch通常用于网站的全文检索，这意味着ElasticSearch将承担着整个系统最大搜索量的搜索业务。然而在如此大数据量的情况下，ElasticSearch仍然能够非常出色的完成任务：</p><p>示例：</p><p>  关系型数据库中的数据表</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#adbac7;">+----+------------+</span></span>
<span class="line"><span style="color:#adbac7;">| id | name       |</span></span>
<span class="line"><span style="color:#adbac7;">+----+------------+</span></span>
<span class="line"><span style="color:#adbac7;">|  1 | zhang san  |</span></span>
<span class="line"><span style="color:#adbac7;">|  2 | zhang san2 |</span></span>
<span class="line"><span style="color:#adbac7;">|  3 | zhang san3 |</span></span>
<span class="line"><span style="color:#adbac7;">|  4 | li si      |</span></span>
<span class="line"><span style="color:#adbac7;">+----+------------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">+----+------------+</span></span>
<span class="line"><span style="color:#24292e;">| id | name       |</span></span>
<span class="line"><span style="color:#24292e;">+----+------------+</span></span>
<span class="line"><span style="color:#24292e;">|  1 | zhang san  |</span></span>
<span class="line"><span style="color:#24292e;">|  2 | zhang san2 |</span></span>
<span class="line"><span style="color:#24292e;">|  3 | zhang san3 |</span></span>
<span class="line"><span style="color:#24292e;">|  4 | li si      |</span></span>
<span class="line"><span style="color:#24292e;">+----+------------+</span></span></code></pre></div><p>  假设这张数据表的数据量非常庞大，若是想进行模糊查询，查询姓 zhang 的用户信息，那么它的效率一定是很低的，因为它需要从第一条数据开始遍历到最后一条数据。来看看ElasticSearch是如何做的，它采用的是一种叫 倒排索引 的方式，即：在插入数据的时候就建立了一张关键字与id的对应表：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#adbac7;">+---------+-------+</span></span>
<span class="line"><span style="color:#adbac7;">| keyword | id    |</span></span>
<span class="line"><span style="color:#adbac7;">+----+------------+</span></span>
<span class="line"><span style="color:#adbac7;">|  zhang  | 1,2,3 |</span></span>
<span class="line"><span style="color:#adbac7;">|   san   | 1,2,3 |</span></span>
<span class="line"><span style="color:#adbac7;">|    li   |   4   |</span></span>
<span class="line"><span style="color:#adbac7;">|    si   |   4   |</span></span>
<span class="line"><span style="color:#adbac7;">+---------+-------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">+---------+-------+</span></span>
<span class="line"><span style="color:#24292e;">| keyword | id    |</span></span>
<span class="line"><span style="color:#24292e;">+----+------------+</span></span>
<span class="line"><span style="color:#24292e;">|  zhang  | 1,2,3 |</span></span>
<span class="line"><span style="color:#24292e;">|   san   | 1,2,3 |</span></span>
<span class="line"><span style="color:#24292e;">|    li   |   4   |</span></span>
<span class="line"><span style="color:#24292e;">|    si   |   4   |</span></span>
<span class="line"><span style="color:#24292e;">+---------+-------+</span></span></code></pre></div><p>  它会将名字中的关键字提取出来，并记录当前id拥有哪些关键字，将其存放起来，此时我们查询姓 zhang 的用户信息时，我们将直接得到姓 zhang 的用户id为 1、2、3 ，然后通过id找到用户信息即可，查询效率大幅提升了。</p><h3 id="es相关名词解释" tabindex="-1">es相关名词解释 <a class="header-anchor" href="#es相关名词解释" aria-label="Permalink to &quot;es相关名词解释&quot;">​</a></h3><h4 id="索引-index" tabindex="-1">索引（Index） <a class="header-anchor" href="#索引-index" aria-label="Permalink to &quot;索引（Index）&quot;">​</a></h4><p>  一个索引就是一个拥有几分相似特征的文档的集合。一个索引由一个名字来标识（必须全部是小写字母），并且当我们要对这个索引中的文档进行索引、搜索、更新和删除的时候，都要使用到这个名字。在一个集群中，可以定义任意多的索引。能搜索的数据必须索引，这样的好处是可以提高查询速度，比如：新华字典前面的目录就是索引的意思，目录可以提高查询速度。</p><p>  Elasticsearch 索引的精髓：一切设计都是为了提高搜索的性能。</p><h4 id="文档-document" tabindex="-1">文档（Document） <a class="header-anchor" href="#文档-document" aria-label="Permalink to &quot;文档（Document）&quot;">​</a></h4><p>  es中的最小数据单元</p><p>  一个文档是一个可被索引的基础信息单元，也就是一条数据。文档以 JSON（Javascript Object Notation）格式来表示，而 JSON 是一个到处存在的互联网数据交互格式。在一个 index 里面，你可以存储任意多的文档。</p><h4 id="字段-field" tabindex="-1">字段（Field） <a class="header-anchor" href="#字段-field" aria-label="Permalink to &quot;字段（Field）&quot;">​</a></h4><p>  相当于是数据表的字段，对文档数据根据不同属性进行的分类标识。每个字段可能多次出现在一个文档里，这样的字段叫多值字段（multivalued）</p><h4 id="映射-mapping" tabindex="-1">映射（Mapping） <a class="header-anchor" href="#映射-mapping" aria-label="Permalink to &quot;映射（Mapping）&quot;">​</a></h4><p> mapping 是处理数据的方式和规则方面做一些限制，如：某个字段的数据类型、默认值、分析器、是否被索引等等。这些都是映射里面可以设置的，其它就是处理 ES 里面数据的一些使用规则设置也叫做映射，按着最优规则处理数据对性能提高很大，因此才需要建立映射，并且需要思考如何建立映射才能对性能更好。</p><h4 id="分片-shards" tabindex="-1">分片（Shards） <a class="header-anchor" href="#分片-shards" aria-label="Permalink to &quot;分片（Shards）&quot;">​</a></h4><p>  一个索引可以存储超出单个节点硬件限制的大量数据。比如，一个具有 10 亿文档数据的索引占据 1TB 的磁盘空间，而任一节点都可能没有这样大的磁盘空间。或者单个节点处理搜索请求，响应太慢。为了解决这个问题，Elasticsearch 提供了将索引划分成多份的能力，每一份就称之为分片。当你创建一个索引的时候，你可以指定你想要的分片的数量。每个分片本身也是一个功能完善并且独立的“索引”，这个“索引”可以被放置到集群中的任何节点上。</p><p>  分片很重要，主要有两方面的原因：</p><ol><li>允许你水平分割 / 扩展你的内容容量。</li><li>允许你在分片之上进行分布式的、并行的操作，进而提高性能/吞吐量。</li></ol><p>  至于一个分片怎样分布，它的文档怎样聚合和搜索请求，是完全由 Elasticsearch 管理的，对于作为用户的你来说，这些都是透明的，无需过分关心。 能正常提供查询和插入的分片我们叫做主分片（primary shard），其余的我们就管他们叫做备份的分片（replica shard）。</p><h4 id="副本-replicas" tabindex="-1">副本（Replicas） <a class="header-anchor" href="#副本-replicas" aria-label="Permalink to &quot;副本（Replicas）&quot;">​</a></h4><p>  在一个网络 / 云的环境里，失败随时都可能发生，在某个分片/节点不知怎么的就处于离线状态，或者由于任何原因消失了，这种情况下，有一个故障转移机制是非常有用并且是强烈推荐的。为此目的，Elasticsearch 允许你创建分片的一份或多份拷贝，这些拷贝叫做复制分片(副本)。</p><p>  复制分片之所以重要，有两个主要原因：</p><ol><li>在分片/节点失败的情况下，提供了高可用性。因为这个原因，注意到复制分片从不与原/主要（original/primary）分片置于同一节点上是非常重要的。</li><li>扩展你的搜索量/吞吐量，因为搜索可以在所有的副本上并行运行。</li></ol><p>  总之，每个索引可以被分成多个分片。一个索引也可以被复制 0 次（意思是没有复制）或多次。一旦复制了，每个索引就有了主分片（作为复制源的原来的分片）和复制分片（主分片的拷贝）之别。分片和复制的数量可以在索引创建的时候指定。在索引创建之后，你可以在任何时候动态地改变复制的数量，但是你事后不能改变分片的数量。</p><p>  默认情况下，Elasticsearch 中的每个索引被分片 1 个主分片和 1 个复制，这意味着，如果你的集群中至少有两个节点，你的索引将会有 1 个主分片和另外 1 个复制分片（1 个完全拷贝），这样的话每个索引总共就有 2 个分片，我们需要根据索引需要确定分片个数。</p><h3 id="es安装" tabindex="-1">es安装 <a class="header-anchor" href="#es安装" aria-label="Permalink to &quot;es安装&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">#创建elsearch用户，Elasticsearch不支持root用户运行</span></span>
<span class="line"><span style="color:#F69D50;">useradd</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">elsearch</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">#解压安装包</span></span>
<span class="line"><span style="color:#F69D50;">tar</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-xvf</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">elasticsearch-6.5.4.tar.gz</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-C</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/itcast/es/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">#修改配置文件</span></span>
<span class="line"><span style="color:#F69D50;">vim</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">conf/elasticsearch.yml</span></span>
<span class="line"><span style="color:#F69D50;">network.host:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0.0</span><span style="color:#96D0FF;">.0.0</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;">#设置ip地址，任意网络均可访问</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">#启动ES服务</span></span>
<span class="line"><span style="color:#F69D50;">su</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">-</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">elsearch</span></span>
<span class="line"><span style="color:#6CB6FF;">cd</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">bin</span></span>
<span class="line"><span style="color:#F69D50;">./elasticsearch</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">或</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">./elasticsearch</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-d</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;">#后台启动</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;"># 启动成功后，访问9200端口</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#创建elsearch用户，Elasticsearch不支持root用户运行</span></span>
<span class="line"><span style="color:#6F42C1;">useradd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">elsearch</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#解压安装包</span></span>
<span class="line"><span style="color:#6F42C1;">tar</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-xvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">elasticsearch-6.5.4.tar.gz</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-C</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/itcast/es/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#修改配置文件</span></span>
<span class="line"><span style="color:#6F42C1;">vim</span><span style="color:#24292E;"> </span><span style="color:#032F62;">conf/elasticsearch.yml</span></span>
<span class="line"><span style="color:#6F42C1;">network.host:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.0</span><span style="color:#032F62;">.0.0</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#设置ip地址，任意网络均可访问</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#启动ES服务</span></span>
<span class="line"><span style="color:#6F42C1;">su</span><span style="color:#24292E;"> </span><span style="color:#032F62;">-</span><span style="color:#24292E;"> </span><span style="color:#032F62;">elsearch</span></span>
<span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bin</span></span>
<span class="line"><span style="color:#6F42C1;">./elasticsearch</span><span style="color:#24292E;"> </span><span style="color:#032F62;">或</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./elasticsearch</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#后台启动</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 启动成功后，访问9200端口</span></span></code></pre></div><h3 id="es常用的配置项" tabindex="-1">es常用的配置项 <a class="header-anchor" href="#es常用的配置项" aria-label="Permalink to &quot;es常用的配置项&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">cluster.name:</span><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#768390;"># 配置elasticsearch的集群名称，默认是elasticsearch。建议修改成一个有意义的名称。</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">node.name:</span></span>
<span class="line"><span style="color:#768390;"># 节点名，通常一台物理服务器就是一个节点，es会默认随机指定一个名字，建议指定一个有意义的名称，方便管理</span></span>
<span class="line"><span style="color:#768390;"># 一个或多个节点组成一个cluster集群，集群是一个逻辑的概念，节点是物理概念。</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">path.conf:</span><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#768390;"># 设置配置文件的存储路径，tar或zip包安装默认在es根目录下的config文件夹，rpm安装默认在/etc/elasticsearch</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">path.data:</span></span>
<span class="line"><span style="color:#768390;"># 设置索引数据的存储路径，默认是es根目录下的data文件夹，可以设置多个存储路径，用逗号隔开。</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">path.logs:</span></span>
<span class="line"><span style="color:#768390;"># 设置日志文件的存储路径，默认是es根目录下的logs文件夹</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">path.plugins:</span><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#768390;"># 设置插件的存放路径，默认是es根目录下的plugins文件夹</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">bootstrap.memory_lock:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">true</span></span>
<span class="line"><span style="color:#768390;"># 设置为true可以锁住ES使用的内存，避免内存与swap分区交换数据。</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">network.host:</span><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#768390;"># 设置绑定主机的ip地址，设置为0.0.0.0表示绑定任何ip，允许外网访问，生产环境建议设置为具体的ip。</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">http.port:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">9200</span></span>
<span class="line"><span style="color:#768390;"># 设置对外服务的http端口，默认为9200。</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">transport.tcp.port:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">9300</span><span style="color:#ADBAC7;">  </span></span>
<span class="line"><span style="color:#768390;"># 集群结点之间通信端口</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span></span>
<span class="line"><span style="color:#F69D50;">node.master:</span><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#768390;"># 指定该节点是否有资格被选举成为master结点，默认是true，如果原来的master宕机会重新选举新的master。</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">node.data:</span><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#768390;"># 指定该节点是否存储索引数据，默认为true。</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">node.ingest:</span><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#768390;"># 是否允许成为协调节点</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">discovery.zen.ping.unicast.hosts:</span><span style="color:#ADBAC7;"> [</span><span style="color:#96D0FF;">&quot;host1:port&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;host2:port&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;...&quot;]</span></span>
<span class="line"><span style="color:#768390;"># 设置集群中master节点的初始列表。</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">discovery.zen.ping.timeout:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">3</span><span style="color:#96D0FF;">s</span></span>
<span class="line"><span style="color:#768390;"># 设置ES自动发现节点连接超时的时间，默认为3秒，如果网络延迟高可设置大些。</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">discovery.zen.minimum_master_nodes:</span></span>
<span class="line"><span style="color:#768390;"># 主结点数量的最少值 ,此值的公式为：(master_eligible_nodes / 2) + 1 ，比如：有3个符合要求的主结点，那么这里要设置为2。</span></span>
<span class="line"><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#F69D50;">node.max_local_storage_nodes:</span><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#768390;"># 单机允许的最大存储结点数，通常单机启动一个结点建议设置为1，开发环境如果单机启动多个节点可设置大于1。</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">cluster.name:</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;"># 配置elasticsearch的集群名称，默认是elasticsearch。建议修改成一个有意义的名称。</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">node.name:</span></span>
<span class="line"><span style="color:#6A737D;"># 节点名，通常一台物理服务器就是一个节点，es会默认随机指定一个名字，建议指定一个有意义的名称，方便管理</span></span>
<span class="line"><span style="color:#6A737D;"># 一个或多个节点组成一个cluster集群，集群是一个逻辑的概念，节点是物理概念。</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">path.conf:</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;"># 设置配置文件的存储路径，tar或zip包安装默认在es根目录下的config文件夹，rpm安装默认在/etc/elasticsearch</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">path.data:</span></span>
<span class="line"><span style="color:#6A737D;"># 设置索引数据的存储路径，默认是es根目录下的data文件夹，可以设置多个存储路径，用逗号隔开。</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">path.logs:</span></span>
<span class="line"><span style="color:#6A737D;"># 设置日志文件的存储路径，默认是es根目录下的logs文件夹</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">path.plugins:</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;"># 设置插件的存放路径，默认是es根目录下的plugins文件夹</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">bootstrap.memory_lock:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#6A737D;"># 设置为true可以锁住ES使用的内存，避免内存与swap分区交换数据。</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">network.host:</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;"># 设置绑定主机的ip地址，设置为0.0.0.0表示绑定任何ip，允许外网访问，生产环境建议设置为具体的ip。</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">http.port:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">9200</span></span>
<span class="line"><span style="color:#6A737D;"># 设置对外服务的http端口，默认为9200。</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">transport.tcp.port:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">9300</span><span style="color:#24292E;">  </span></span>
<span class="line"><span style="color:#6A737D;"># 集群结点之间通信端口</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#6F42C1;">node.master:</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;"># 指定该节点是否有资格被选举成为master结点，默认是true，如果原来的master宕机会重新选举新的master。</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">node.data:</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;"># 指定该节点是否存储索引数据，默认为true。</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">node.ingest:</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;"># 是否允许成为协调节点</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">discovery.zen.ping.unicast.hosts:</span><span style="color:#24292E;"> [</span><span style="color:#032F62;">&quot;host1:port&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;host2:port&quot;,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;...&quot;]</span></span>
<span class="line"><span style="color:#6A737D;"># 设置集群中master节点的初始列表。</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">discovery.zen.ping.timeout:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">s</span></span>
<span class="line"><span style="color:#6A737D;"># 设置ES自动发现节点连接超时的时间，默认为3秒，如果网络延迟高可设置大些。</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">discovery.zen.minimum_master_nodes:</span></span>
<span class="line"><span style="color:#6A737D;"># 主结点数量的最少值 ,此值的公式为：(master_eligible_nodes / 2) + 1 ，比如：有3个符合要求的主结点，那么这里要设置为2。</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">node.max_local_storage_nodes:</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;"># 单机允许的最大存储结点数，通常单机启动一个结点建议设置为1，开发环境如果单机启动多个节点可设置大于1。</span></span></code></pre></div><h3 id="es集群" tabindex="-1">es集群 <a class="header-anchor" href="#es集群" aria-label="Permalink to &quot;es集群&quot;">​</a></h3><h4 id="集群的发现机制" tabindex="-1">集群的发现机制 <a class="header-anchor" href="#集群的发现机制" aria-label="Permalink to &quot;集群的发现机制&quot;">​</a></h4><p>  ES 内部是如何通过一个相同的设置 cluster.name 就能将不同的节点连接到同一个集群的？</p><p>  答案是 Zen Discovery。</p><ul><li>Zen Discovery 是 Elasticsearch 的内置默认发现模块（发现模块的职责是发现集群中的节点以及选举 Master 节点）。</li><li>它提供单播和基于文件的发现，并且可以扩展为通过插件支持云环境和其他形式的发现。</li><li>Elasticsearch 默认被配置为使用单播发现，以防止节点无意中加入集群。只有在同一台机器上运行的节点才会自动组成集群。</li><li>如果集群的节点运行在不同的机器上，使用单播，你可以为 Elasticsearch 提供一些它应该去尝试连接的节点列表。当一个节点联系到单播列表中的成员时，它就会得到整个集群所有节点的状态，然后它会联系 Master 节点，并加入集群。这意味着单播列表不需要包含集群中的所有节点， 它只是需要足够的节点，当一个新节点联系上其中一个并且说上话就可以了。</li><li>节点启动后先 Ping ，如果 discovery.zen.ping.unicast.hosts 有设置，则 Ping 设置中的 Host ，否则尝试 ping localhost 的几个端口。</li></ul><h4 id="集群的选举机制" tabindex="-1">集群的选举机制 <a class="header-anchor" href="#集群的选举机制" aria-label="Permalink to &quot;集群的选举机制&quot;">​</a></h4><ul><li>选举开始，先从各节点认为的 Master 中选，规则很简单，按照 ID 的字典序排序，取第一个。如果各节点都没有认为的 Master ，则从所有节点中选择，规则同上。这里有个限制条件就是 discovery.zen.minimum_master_nodes ，如果节点数达不到最小值的限制，则循环上述过程，直到节点数足够可以开始选举。</li><li>最后选举结果是肯定能选举出一个 Master ，如果只有一个 Local 节点那就选出的是自己。</li><li>如果当前节点是 Master ，则开始等待节点数达到 discovery.zen.minimum_master_nodes，然后提供服务。</li><li>如果当前节点不是 Master ，则尝试加入 Master 。Elasticsearch 将以上服务发现以及选主的流程叫做 Zen Discovery 。</li><li>由于它支持任意数目的集群（ 1- N ），所以不能像 Zookeeper 那样限制节点必须是奇数，也就无法用投票的机制来选主，而是通过一个规则。只要所有的节点都遵循同样的规则，得到的信息都是对等的，选出来的主节点肯定是一致的。</li><li>但分布式系统的问题就出在信息不对等的情况，这时候很容易出现脑裂（Split-Brain）的问题。大多数解决方案就是设置一个 Quorum 值，要求可用节点必须大于 Quorum（一般是超过半数节点），才能对外提供服务。而 Elasticsearch 中，这个 Quorum 的配置就是 discovery.zen.minimum_master_nodes</li></ul><h4 id="脑裂现象" tabindex="-1">脑裂现象 <a class="header-anchor" href="#脑裂现象" aria-label="Permalink to &quot;脑裂现象&quot;">​</a></h4><p>  同时如果由于网络或其他原因导致集群中选举出多个 Master 节点，使得数据更新时出现不一致，这种现象称之为脑裂，即集群中不同的节点对于 Master 的选择出现了分歧，出现了多个 Master 竞争。</p><ul><li>脑裂问题的原因： <ul><li>网络问题： 集群间的网络延迟导致一些节点访问不到Master，认为Master挂掉了，从而选举出新的Master，并对Master上的分片和副本标红，分配新的主分片</li><li>节点负载： 主节点的角色既为 Master 又为 Data，访问量较大时可能会导致 ES 停止响应（假死状态）造成大面积延迟，此时其他节点得不到主节点的响应认为主节点挂掉了，会重新选取主节点。</li><li>内存回收： 主节点的角色既为 Master 又为 Data，当 Data 节点上的 ES 进程占用的内存较大，引发 JVM 的大规模内存回收，造成 ES 进程失去响应。</li></ul></li><li>优化措施： <ul><li>适当调大响应时间，减少误判。 通过参数 discovery.zen.ping_timeout 设置节点状态的响应时间，默认为 3s，可以适当调大。如果 Master 在该响应时间的范围内没有做出响应应答，判断该节点已经挂掉了。调大参数（如 6s，discovery.zen.ping_timeout:6），可适当减少误判。</li><li>选举触发。 我们需要在候选集群中的节点的配置文件中设置参数 discovery.zen.munimum_master_nodes 的值。这个参数表示在选举主节点时需要参与选举的候选主节点的节点数，默认值是 1，官方建议取值(master_eligibel_nodes / 2)+1，其中 master_eligibel_nodes 为候选主节点的个数。这样做既能防止脑裂现象的发生，也能最大限度地提升集群的高可用性，因为只要不少于 discovery.zen.munimum_master_nodes 个候选节点存活，选举工作就能正常进行。当小于这个值的时候，无法触发选举行为，集群无法使用，不会造成分片混乱的情况。</li><li>角色分离。 候选主节点和数据节点进行角色分离，这样可以减轻主节点的负担，防止主节点的假死状态发生，减少对主节点“已死”的误判。</li></ul></li></ul><h4 id="数据路由" tabindex="-1">数据路由 <a class="header-anchor" href="#数据路由" aria-label="Permalink to &quot;数据路由&quot;">​</a></h4><p>  一个文档，最终会落在主分片的一个分片上，到底应该在哪一个分片？ 这就是数据路由。</p><p>路由算法（哈希值对主分片数取模）</p><p>  shard = hash(routing) % number_of_primary_shards</p><p>  （ routing默认为文档_id；可能是手动指定，也可能是自动生成）</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#adbac7;">// 手动指定 routing number</span></span>
<span class="line"><span style="color:#adbac7;">PUT /test_index/_doc/15?routing=num</span></span>
<span class="line"><span style="color:#adbac7;">{</span></span>
<span class="line"><span style="color:#adbac7;">    &quot;num&quot;: 0,</span></span>
<span class="line"><span style="color:#adbac7;">    &quot;tags&quot;: []</span></span>
<span class="line"><span style="color:#adbac7;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">// 手动指定 routing number</span></span>
<span class="line"><span style="color:#24292e;">PUT /test_index/_doc/15?routing=num</span></span>
<span class="line"><span style="color:#24292e;">{</span></span>
<span class="line"><span style="color:#24292e;">    &quot;num&quot;: 0,</span></span>
<span class="line"><span style="color:#24292e;">    &quot;tags&quot;: []</span></span>
<span class="line"><span style="color:#24292e;">}</span></span></code></pre></div><p>场景：</p><p>  在程序中，架构师可以手动指定已有数据的一个属性为路由值，好处是可以定制一类文档数据存储到一个分片中。缺点是设计不好，会造成数据倾斜。</p><p>  所以，不同文档尽量放到不同的索引中。剩下的事情交给es集群自己处理。</p><h4 id="文档的增删改内部机制" tabindex="-1">文档的增删改内部机制 <a class="header-anchor" href="#文档的增删改内部机制" aria-label="Permalink to &quot;文档的增删改内部机制&quot;">​</a></h4><h5 id="增删改" tabindex="-1">增删改 <a class="header-anchor" href="#增删改" aria-label="Permalink to &quot;增删改&quot;">​</a></h5><p>  增删改可以看做update,都是对数据的改动。一个改动请求发送到es集群，具体流程如下：</p><ul><li>客户端向 ES1 节点（协调节点）发送写请求，通过路由计算公式得到值为 0，则当前数据应被写到主分片 S0 上。</li><li>ES1 节点将请求转发到 S0 主分片所在的节点 ES3，ES3 接受请求并写入到磁盘。</li><li>并发将数据复制到两个副本分片 R0 上，其中通过乐观并发控制数据的冲突。一旦所有的副本分片都报告成功，则节点 ES3 将向协调节点报告成功，协调节点向客户端报告成功。 <img src="/charles-blog/assets/EsWriteData.ebe6a9ef.png" alt="EsWriteData"></li></ul><h5 id="查询" tabindex="-1">查询 <a class="header-anchor" href="#查询" aria-label="Permalink to &quot;查询&quot;">​</a></h5><ol><li>客户端发送请求到任意一个节点，成为协调节点</li><li>协调节点对文档进行路由，将请求转发到对应的节点，此时会使用round-robin随机轮询算法，在主分片以及其所有副本分片中随机选择一个，让读请求负载均衡</li><li>接收请求的节点返回文档给协调节点</li><li>协调节点返回文档给客户端</li><li>特殊情况：文档如果还在建立索引过程中，可能只有主分片有，任何一个副本分片都没有，此时可能会导致无法读取到文档，但是文档完成索引建立之后，主分片和副本分片就都有了。</li></ol><h3 id="es存储原理" tabindex="-1">es存储原理 <a class="header-anchor" href="#es存储原理" aria-label="Permalink to &quot;es存储原理&quot;">​</a></h3><ul><li>分段存储</li><li>延迟写</li><li>段合并</li></ul><h4 id="写索引的流程-延迟写" tabindex="-1">写索引的流程：（延迟写） <a class="header-anchor" href="#写索引的流程-延迟写" aria-label="Permalink to &quot;写索引的流程：（延迟写）&quot;">​</a></h4><ul><li>一个新文档被索引之后，先被写入到内存中，但是为了防止数据的丢失，会追加一份数据到事务日志中。</li><li>不断有新的文档被写入到内存，同时也都会记录到事务日志中。这时新数据还不能被检索和查询。</li><li>当达到默认的刷新时间或内存中的数据达到一定量后，会触发一次 Refresh，将内存中的数据以一个新段形式刷新到文件缓存系统中并清空内存。这时虽然新段未被提交到磁盘，但是可以提供文档的检索功能且不能被修改。</li><li>随着新文档索引不断被写入，当日志数据大小超过 512M 或者时间超过 30 分钟时，会触发一次 Flush。</li><li>通过这种方式当断电或需要重启时，ES 不仅要根据提交点去加载已经持久化过的段，还需要工具 Translog 里的记录，把未持久化的数据重新持久化到磁盘上，避免了数据丢失的可能。 <img src="/charles-blog/assets/EsWriteIndex.75cb6b7d.png" alt="EsWriteIndex"></li></ul><h3 id="分词器-analyzer" tabindex="-1">分词器 analyzer <a class="header-anchor" href="#分词器-analyzer" aria-label="Permalink to &quot;分词器 analyzer&quot;">​</a></h3><p> 作用：切分词语，normalization，提升recall召回率（搜索的时候，增加能够搜索到的结果的数量）</p><p>  给你一段句子，然后将这段句子拆分成一个一个的单个的单词，同时对每个单词进行normalization（时态转换，单复数转换）</p><h4 id="analyzer-组成部分" tabindex="-1">analyzer 组成部分 <a class="header-anchor" href="#analyzer-组成部分" aria-label="Permalink to &quot;analyzer 组成部分&quot;">​</a></h4><h5 id="character-filter" tabindex="-1">character filter <a class="header-anchor" href="#character-filter" aria-label="Permalink to &quot;character filter&quot;">​</a></h5><p>  在一段文本进行分词之前，先进行预处理，比如说最常见的就是，过滤html标签</p><p> （&lt;span&gt;hello&lt;span&gt; --&gt; hello），&amp; --&gt; and（I&amp;you --&gt; I and you）</p><h5 id="tokenizer" tabindex="-1">tokenizer <a class="header-anchor" href="#tokenizer" aria-label="Permalink to &quot;tokenizer&quot;">​</a></h5><p>  分词 hello you and me --&gt; hello, you, and, me</p><h5 id="token-filter" tabindex="-1">token filter <a class="header-anchor" href="#token-filter" aria-label="Permalink to &quot;token filter&quot;">​</a></h5><p>lowercase（Tom --&gt; tom）</p><p>stop word（a/the/an）</p><p>synonymom（dogs --&gt; dog，liked --&gt; like，mother --&gt; mom，small --&gt; little）</p><p>  一个分词器，很重要，将一段文本进行各种处理，最后处理好的结果才会拿去建立倒排索引。</p><h4 id="重建倒排索引" tabindex="-1">重建倒排索引 <a class="header-anchor" href="#重建倒排索引" aria-label="Permalink to &quot;重建倒排索引&quot;">​</a></h4><p>  normalization正规化，建立倒排索引的时候，会执行一个操作，也就是说对拆分出的各个单词进行相应的处理，以提升后面搜索的时候能够搜索到相关联的文档的概率时态的转换，单复数的转换，同义词的转换，大小写的转换。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#adbac7;">mom ―&gt; mother</span></span>
<span class="line"><span style="color:#adbac7;">liked ―&gt; like</span></span>
<span class="line"><span style="color:#adbac7;">small ―&gt; little</span></span>
<span class="line"><span style="color:#adbac7;">dogs ―&gt; dog</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">mom ―&gt; mother</span></span>
<span class="line"><span style="color:#24292e;">liked ―&gt; like</span></span>
<span class="line"><span style="color:#24292e;">small ―&gt; little</span></span>
<span class="line"><span style="color:#24292e;">dogs ―&gt; dog</span></span></code></pre></div><h3 id="es的http操作" tabindex="-1">es的http操作 <a class="header-anchor" href="#es的http操作" aria-label="Permalink to &quot;es的http操作&quot;">​</a></h3><h4 id="_1、索引操作" tabindex="-1">1、索引操作 <a class="header-anchor" href="#_1、索引操作" aria-label="Permalink to &quot;1、索引操作&quot;">​</a></h4><h5 id="_1-1、创建索引" tabindex="-1">1.1、创建索引 <a class="header-anchor" href="#_1-1、创建索引" aria-label="Permalink to &quot;1.1、创建索引&quot;">​</a></h5><p>  对比关系型数据库，创建索引就等同于创建数据库</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">PUT请求：http://127.0.0.1:9200/索引名</span></span>
<span class="line"><span style="color:#768390;"># 返回结果:</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;acknowledged&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">true</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;">  </span><span style="color:#768390;">#【响应结果】: true（操作成功）</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;shards_acknowledged&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">true</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;">#【分片结果】: true（分片操作成功）；创建索引库的分片数默认1片，在7.0.0之前版本中，默认5片</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;index&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;shopping&quot;</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 索引名称</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">PUT请求：http://127.0.0.1:9200/索引名</span></span>
<span class="line"><span style="color:#6A737D;"># 返回结果:</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;acknowledged&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span><span style="color:#032F62;">,</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">#【响应结果】: true（操作成功）</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;shards_acknowledged&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#【分片结果】: true（分片操作成功）；创建索引库的分片数默认1片，在7.0.0之前版本中，默认5片</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;index&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;shopping&quot;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 索引名称</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_1-2、查看所有索引" tabindex="-1">1.2、查看所有索引 <a class="header-anchor" href="#_1-2、查看所有索引" aria-label="Permalink to &quot;1.2、查看所有索引&quot;">​</a></h5><p>  类似于MySQL中的show tables</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET请求：http://127.0.0.1:9200/_cat/indices?v</span></span>
<span class="line"><span style="color:#768390;"># 参数说明：</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">a</span><span style="color:#ADBAC7;">) _cat 表示查看的意思;</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">b</span><span style="color:#ADBAC7;">) indices表示索引</span></span>
<span class="line"><span style="color:#768390;"># 返回结果：</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">health</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">status</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">index</span><span style="color:#ADBAC7;">    </span><span style="color:#96D0FF;">uuid</span><span style="color:#ADBAC7;">                   </span><span style="color:#96D0FF;">pri</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">rep</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">docs.count</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">docs.deleted</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">store.size</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">pri.store.size</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">yellow</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">open</span><span style="color:#ADBAC7;">   </span><span style="color:#96D0FF;">shopping</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">4</span><span style="color:#96D0FF;">h4Dmkn4TvWvkYcmHFeqFA</span><span style="color:#ADBAC7;">   </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">   </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">          </span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">            </span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">       </span><span style="color:#6CB6FF;">208</span><span style="color:#96D0FF;">b</span><span style="color:#ADBAC7;">           </span><span style="color:#6CB6FF;">208</span><span style="color:#96D0FF;">b</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">表头说明：</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">a</span><span style="color:#ADBAC7;">) health：当前服务器健康状态; </span><span style="color:#F69D50;">green(集群完整</span><span style="color:#ADBAC7;">) yellow(</span><span style="color:#F69D50;">单点正常、集群不完整</span><span style="color:#ADBAC7;">) red(</span><span style="color:#F69D50;">单点不正常</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">b</span><span style="color:#ADBAC7;">) status：索引打开、关闭状态</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">c</span><span style="color:#ADBAC7;">) index：索引名</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">d</span><span style="color:#ADBAC7;">) uuid：索引统一编号</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">e</span><span style="color:#ADBAC7;">) pri：主分片数量</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">f</span><span style="color:#ADBAC7;">) rep：副本数量</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">g</span><span style="color:#ADBAC7;">) docs.count：可用文档数量</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">h</span><span style="color:#ADBAC7;">) docs.deleted：文档删除状态（逻辑删除）</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">i</span><span style="color:#ADBAC7;">) store.size：主分片和副分片整体占空间大小</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">j</span><span style="color:#ADBAC7;">) pri.store.size：主分片占空间大小</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET请求：http://127.0.0.1:9200/_cat/indices?v</span></span>
<span class="line"><span style="color:#6A737D;"># 参数说明：</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">a</span><span style="color:#24292E;">) _cat 表示查看的意思;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">b</span><span style="color:#24292E;">) indices表示索引</span></span>
<span class="line"><span style="color:#6A737D;"># 返回结果：</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">health</span><span style="color:#24292E;"> </span><span style="color:#032F62;">status</span><span style="color:#24292E;"> </span><span style="color:#032F62;">index</span><span style="color:#24292E;">    </span><span style="color:#032F62;">uuid</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">pri</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docs.count</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docs.deleted</span><span style="color:#24292E;"> </span><span style="color:#032F62;">store.size</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pri.store.size</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">yellow</span><span style="color:#24292E;"> </span><span style="color:#032F62;">open</span><span style="color:#24292E;">   </span><span style="color:#032F62;">shopping</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4</span><span style="color:#032F62;">h4Dmkn4TvWvkYcmHFeqFA</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">            </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">       </span><span style="color:#005CC5;">208</span><span style="color:#032F62;">b</span><span style="color:#24292E;">           </span><span style="color:#005CC5;">208</span><span style="color:#032F62;">b</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">表头说明：</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">a</span><span style="color:#24292E;">) health：当前服务器健康状态; </span><span style="color:#6F42C1;">green(集群完整</span><span style="color:#24292E;">) yellow(</span><span style="color:#6F42C1;">单点正常、集群不完整</span><span style="color:#24292E;">) red(</span><span style="color:#6F42C1;">单点不正常</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">b</span><span style="color:#24292E;">) status：索引打开、关闭状态</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">c</span><span style="color:#24292E;">) index：索引名</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">d</span><span style="color:#24292E;">) uuid：索引统一编号</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">e</span><span style="color:#24292E;">) pri：主分片数量</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">f</span><span style="color:#24292E;">) rep：副本数量</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">g</span><span style="color:#24292E;">) docs.count：可用文档数量</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">h</span><span style="color:#24292E;">) docs.deleted：文档删除状态（逻辑删除）</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">i</span><span style="color:#24292E;">) store.size：主分片和副分片整体占空间大小</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">j</span><span style="color:#24292E;">) pri.store.size：主分片占空间大小</span></span></code></pre></div><h5 id="_1-3、查看单个索引" tabindex="-1">1.3、查看单个索引 <a class="header-anchor" href="#_1-3、查看单个索引" aria-label="Permalink to &quot;1.3、查看单个索引&quot;">​</a></h5><p>  查看索引发送的请求路径和创建索引是一致的。但是HTTP方法不一致</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET请求：http://127.0.0.1:9200/shopping</span></span>
<span class="line"><span style="color:#768390;"># 返回结果：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;shopping&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 索引名</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;aliases&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{},</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 别名</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;mappings&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{},</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 映射</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;settings&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 设置</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;index&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 索引的设置</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;creation_date&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;1663071606626&quot;,</span><span style="color:#ADBAC7;">  </span><span style="color:#768390;"># 创建时间</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;number_of_shards&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;1&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 主分片数量</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;number_of_replicas&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;1&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 副本分片数量</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;uuid&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;4h4Dmkn4TvWvkYcmHFeqFA&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 唯一索引</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;version&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 版本信息</span></span>
<span class="line"><span style="color:#ADBAC7;">                        </span><span style="color:#F69D50;">&quot;created&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;7080099&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">                    },</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;provided_name&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;shopping&quot;</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 名称</span></span>
<span class="line"><span style="color:#ADBAC7;">                }</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET请求：http://127.0.0.1:9200/shopping</span></span>
<span class="line"><span style="color:#6A737D;"># 返回结果：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;shopping&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 索引名</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;aliases&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{},</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 别名</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;mappings&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{},</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 映射</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;settings&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 设置</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;index&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 索引的设置</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;creation_date&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;1663071606626&quot;,</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># 创建时间</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;number_of_shards&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;1&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 主分片数量</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;number_of_replicas&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;1&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 副本分片数量</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;uuid&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;4h4Dmkn4TvWvkYcmHFeqFA&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 唯一索引</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;version&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 版本信息</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#6F42C1;">&quot;created&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;7080099&quot;</span></span>
<span class="line"><span style="color:#24292E;">                    },</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;provided_name&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;shopping&quot;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 名称</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_1-4、删除索引" tabindex="-1">1.4、删除索引 <a class="header-anchor" href="#_1-4、删除索引" aria-label="Permalink to &quot;1.4、删除索引&quot;">​</a></h5><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">DELETE请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/shopping</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">DELETE请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/shopping</span></span></code></pre></div><h4 id="_2、文档操作" tabindex="-1">2、文档操作 <a class="header-anchor" href="#_2、文档操作" aria-label="Permalink to &quot;2、文档操作&quot;">​</a></h4><h5 id="_2-1、创建文档" tabindex="-1">2.1、创建文档 <a class="header-anchor" href="#_2-1、创建文档" aria-label="Permalink to &quot;2.1、创建文档&quot;">​</a></h5><p>  文档可以类比为关系型数据库中的表数据，添加的数据格式为JSON格式</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">POST请求：http://127.0.0.1:9200/shopping/_doc</span><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#768390;"># 返回结果：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_index&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;shopping&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 索引名</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_type&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;_doc&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 类型：文档类型</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_id&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;tN_bNoMBYY62oGdvcQCo&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 唯一标识，随机生成；长度为20个字符，URL安全，base64编码，GUID，分布式生成不冲突 </span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_version&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 版本</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;result&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;created&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 结果：create表示创建成功</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_shards&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 分片</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;total&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;">  </span><span style="color:#768390;"># 总数</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;successful&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 成功</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;failed&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 失败</span></span>
<span class="line"><span style="color:#ADBAC7;">        },</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_seq_no&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_primary_term&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span>
<span class="line"><span style="color:#768390;"># 上述例子的唯一标识是随机的，如果想要自定义唯一标识，创建时需要指定</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">POST请求：http://127.0.0.1:9200/shopping/_doc/1</span><span style="color:#ADBAC7;">  </span><span style="color:#96D0FF;">（自定义ID为1）</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">POST请求：http://127.0.0.1:9200/shopping/_doc</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;"># 返回结果：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_index&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;shopping&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 索引名</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_type&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;_doc&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 类型：文档类型</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_id&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;tN_bNoMBYY62oGdvcQCo&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 唯一标识，随机生成；长度为20个字符，URL安全，base64编码，GUID，分布式生成不冲突 </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_version&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 版本</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;result&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;created&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 结果：create表示创建成功</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_shards&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 分片</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;total&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">,</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># 总数</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;successful&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 成功</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;failed&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 失败</span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_seq_no&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_primary_term&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#6A737D;"># 上述例子的唯一标识是随机的，如果想要自定义唯一标识，创建时需要指定</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">POST请求：http://127.0.0.1:9200/shopping/_doc/1</span><span style="color:#24292E;">  </span><span style="color:#032F62;">（自定义ID为1）</span></span></code></pre></div><h5 id="_2-2、查看文档" tabindex="-1">2.2、查看文档 <a class="header-anchor" href="#_2-2、查看文档" aria-label="Permalink to &quot;2.2、查看文档&quot;">​</a></h5><p>  需要指明文档的唯一性标识，类似于MySQL中数据的主键查询</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET请求：http://127.0.0.1:9200/shopping/_doc/1</span></span>
<span class="line"><span style="color:#768390;"># 返回结果：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_index&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;shopping&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 索引名</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_type&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;_doc&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_id&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;1&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_version&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_seq_no&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_primary_term&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;found&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">true</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;">#  查询结果，true为找到</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_source&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 文档源信息</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;title&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;小米手机&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;category&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;小米&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;images&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;http://www.gulixueyuan.com/xm.jpg&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;price&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">3999</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET请求：http://127.0.0.1:9200/shopping/_doc/1</span></span>
<span class="line"><span style="color:#6A737D;"># 返回结果：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_index&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;shopping&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 索引名</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_type&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;_doc&quot;,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_id&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;1&quot;,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_version&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_seq_no&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_primary_term&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;found&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#  查询结果，true为找到</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_source&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 文档源信息</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;title&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;小米手机&quot;,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;category&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;小米&quot;,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;images&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;http://www.gulixueyuan.com/xm.jpg&quot;,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;price&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3999</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_2-3、修改文档" tabindex="-1">2.3、修改文档 <a class="header-anchor" href="#_2-3、修改文档" aria-label="Permalink to &quot;2.3、修改文档&quot;">​</a></h5><p>  和新增文档一样，输入相同的URL地址请求，如果请求体变化，会将原有的数据内容覆盖</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">POST</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/shopping/_doc/1</span></span>
<span class="line"><span style="color:#F69D50;">返回结果：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_index&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;shopping&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_type&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;_doc&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_id&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;1&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_version&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 版本信息</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;result&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;updated&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 结果：update表示数据被更新</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_shards&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;total&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;successful&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;failed&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span></span>
<span class="line"><span style="color:#ADBAC7;">    },</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_seq_no&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_primary_term&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span></span>
<span class="line"><span style="color:#768390;"># 为防止覆盖原有数据，我们在新增时，设置为强制创建，不会覆盖原有文档；如果已经存在，会返回创建失败</span></span>
<span class="line"><span style="color:#F69D50;">PUT请求：</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/test_index/_doc/id/_create</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">POST</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/shopping/_doc/1</span></span>
<span class="line"><span style="color:#6F42C1;">返回结果：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_index&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;shopping&quot;,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_type&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;_doc&quot;,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_id&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;1&quot;,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_version&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 版本信息</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;result&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;updated&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 结果：update表示数据被更新</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_shards&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;total&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;successful&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;failed&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_seq_no&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_primary_term&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#6A737D;"># 为防止覆盖原有数据，我们在新增时，设置为强制创建，不会覆盖原有文档；如果已经存在，会返回创建失败</span></span>
<span class="line"><span style="color:#6F42C1;">PUT请求：</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/test_index/_doc/id/_create</span></span></code></pre></div><h5 id="_2-4、修改字段" tabindex="-1">2.4、修改字段 <a class="header-anchor" href="#_2-4、修改字段" aria-label="Permalink to &quot;2.4、修改字段&quot;">​</a></h5><p>  只修改某一给条数据的局部信息</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">POST请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/shopping/_update/1</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;doc&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;price&quot;</span><span style="color:#F69D50;">:3000.00</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">POST请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/shopping/_update/1</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;doc&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;price&quot;</span><span style="color:#6F42C1;">:3000.00</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_2-5、删除文档" tabindex="-1">2.5、删除文档 <a class="header-anchor" href="#_2-5、删除文档" aria-label="Permalink to &quot;2.5、删除文档&quot;">​</a></h5><p>  删除一个文档不会立即从磁盘上移除，它只是被标记成已删除（逻辑删除）</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">DELETE</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/shopping/_doc/1</span></span>
<span class="line"><span style="color:#768390;"># 返回结果：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_index&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;shopping&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_type&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;_doc&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_id&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;1&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_version&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">4</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 对数据的操作，都会更新版本</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;result&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;deleted&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># deleted 表示数据被标记为删除</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_shards&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;total&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;successful&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;failed&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span></span>
<span class="line"><span style="color:#ADBAC7;">    },</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_seq_no&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">4</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_primary_term&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">DELETE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/shopping/_doc/1</span></span>
<span class="line"><span style="color:#6A737D;"># 返回结果：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_index&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;shopping&quot;,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_type&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;_doc&quot;,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_id&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;1&quot;,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_version&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 对数据的操作，都会更新版本</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;result&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;deleted&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># deleted 表示数据被标记为删除</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_shards&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;total&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;successful&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;failed&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_seq_no&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_primary_term&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="_2-6、删除多条文档" tabindex="-1">2.6、删除多条文档 <a class="header-anchor" href="#_2-6、删除多条文档" aria-label="Permalink to &quot;2.6、删除多条文档&quot;">​</a></h5><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">POST</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/shopping/_delete_by_query</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;match&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;price&quot;</span><span style="color:#F69D50;">:4000.00</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span>
<span class="line"><span style="color:#768390;"># 返回结果：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;took&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2844</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 耗时</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;timed_out&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">false</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 是否超时</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;total&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 总数</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;deleted&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 删除数量</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;batches&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;version_conflicts&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;noops&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;retries&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;bulk&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;search&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span></span>
<span class="line"><span style="color:#ADBAC7;">    },</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;throttled_millis&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;requests_per_second&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-1.0,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;throttled_until_millis&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;failures&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> []</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">POST</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/shopping/_delete_by_query</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;match&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;price&quot;</span><span style="color:#6F42C1;">:4000.00</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#6A737D;"># 返回结果：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;took&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2844</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 耗时</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;timed_out&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 是否超时</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;total&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 总数</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;deleted&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 删除数量</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;batches&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;version_conflicts&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;noops&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;retries&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;bulk&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;search&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;throttled_millis&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;requests_per_second&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-1.0,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;throttled_until_millis&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;failures&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> []</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h4 id="_3、映射操作" tabindex="-1">3、映射操作 <a class="header-anchor" href="#_3、映射操作" aria-label="Permalink to &quot;3、映射操作&quot;">​</a></h4><p>  类似于数据库(database)中的表结构(table)</p><p>  创建数据库表需要设置字段名称，类型，长度，约束等；索引库也一样，需要知道这个类型下有哪些字段，每个字段有哪些约束信息，这就叫做映射。</p><h5 id="_3-1、创建映射" tabindex="-1">3.1、创建映射 <a class="header-anchor" href="#_3-1、创建映射" aria-label="Permalink to &quot;3.1、创建映射&quot;">​</a></h5><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">PUT</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_mapping</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;properties&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;name&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;">{ </span><span style="color:#768390;"># 字段名</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;type&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;text&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 数据类型</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;index&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">true</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 是否索引，默认为 true，可以用来进行搜索</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;stroe&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">false</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># store：是否将数据进行独立存储，默认为 false</span></span>
<span class="line"><span style="color:#ADBAC7;">            },</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;sex&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;">{ </span><span style="color:#768390;"># 字段名</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;type&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;text&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 数据类型</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;index&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">false</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 是否索引，默认为 true，</span></span>
<span class="line"><span style="color:#ADBAC7;">            },</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;age&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;">{ </span><span style="color:#768390;"># 字段名</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;type&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;long&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 数据类型</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;index&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">false</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 是否索引，默认为 true，</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;"># 数据类型：</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">1</span><span style="color:#ADBAC7;">) String类型</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">1.1）text：可分词</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">1.2）keyword：不可分词，数据会作为完整字段进行匹配</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">2</span><span style="color:#ADBAC7;">) Numerical：数值类型</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">2.1）</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">基本数据类型：long、integer、short、byte、double、float、half_float</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">2.2）</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">浮点数的高精度类型：scaled_float</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">3</span><span style="color:#ADBAC7;">) Date：日期类型</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">4</span><span style="color:#ADBAC7;">) Array：数组类型</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">5</span><span style="color:#ADBAC7;">) Object：对象</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">PUT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_mapping</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;properties&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;name&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;">{ </span><span style="color:#6A737D;"># 字段名</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;type&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;text&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 数据类型</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;index&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 是否索引，默认为 true，可以用来进行搜索</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;stroe&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># store：是否将数据进行独立存储，默认为 false</span></span>
<span class="line"><span style="color:#24292E;">            },</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;sex&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;">{ </span><span style="color:#6A737D;"># 字段名</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;type&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;text&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 数据类型</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;index&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 是否索引，默认为 true，</span></span>
<span class="line"><span style="color:#24292E;">            },</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;age&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;">{ </span><span style="color:#6A737D;"># 字段名</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;type&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;long&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 数据类型</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;index&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 是否索引，默认为 true，</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 数据类型：</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">1</span><span style="color:#24292E;">) String类型</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">1.1）text：可分词</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">1.2）keyword：不可分词，数据会作为完整字段进行匹配</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">2</span><span style="color:#24292E;">) Numerical：数值类型</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">2.1）</span><span style="color:#24292E;"> </span><span style="color:#032F62;">基本数据类型：long、integer、short、byte、double、float、half_float</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">2.2）</span><span style="color:#24292E;"> </span><span style="color:#032F62;">浮点数的高精度类型：scaled_float</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">3</span><span style="color:#24292E;">) Date：日期类型</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">4</span><span style="color:#24292E;">) Array：数组类型</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">5</span><span style="color:#24292E;">) Object：对象</span></span></code></pre></div><h5 id="_3-2、查看映射" tabindex="-1">3.2、查看映射 <a class="header-anchor" href="#_3-2、查看映射" aria-label="Permalink to &quot;3.2、查看映射&quot;">​</a></h5><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_mapping</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_mapping</span></span></code></pre></div><h4 id="_4、高级查询" tabindex="-1">4、高级查询 <a class="header-anchor" href="#_4、高级查询" aria-label="Permalink to &quot;4、高级查询&quot;">​</a></h4><p>  基于JSON提供完整的查询DSL来定义查询,DSL(Domain Specific Language特定领域语言）</p><h5 id="_4-1、查询所有文档-match-all" tabindex="-1">4.1、查询所有文档(match_all) <a class="header-anchor" href="#_4-1、查询所有文档-match-all" aria-label="Permalink to &quot;4.1、查询所有文档(match_all)&quot;">​</a></h5><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 这里的 query 代表一个查询对象，里面可以有不同的查询属性</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;match_all&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{}</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 查询类型，例如：match_all(代表查询所有)， match，term ，range 等等</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span>
<span class="line"><span style="color:#768390;"># 返回结果：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;took&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2157</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 查询花费时间，单位毫秒</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;timed_out&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">false</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 是否超时</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_shards&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 分片信息</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;total&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 总数</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;successful&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 成功</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;skipped&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 忽略</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;failed&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 失败 </span></span>
<span class="line"><span style="color:#ADBAC7;">        },</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;hits&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 搜索命中结果</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;total&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 搜索条件匹配的文档总数</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;value&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">5</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 总命中计数的值</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;relation&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;eq&quot;</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 计数规则，eq 表示计数准确，gte 表示计数不准确</span></span>
<span class="line"><span style="color:#ADBAC7;">            },</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;max_score&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1.0</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 匹配度分值</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;hits&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> [...] </span><span style="color:#768390;"># 命中结果集合</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 这里的 query 代表一个查询对象，里面可以有不同的查询属性</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;match_all&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{}</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 查询类型，例如：match_all(代表查询所有)， match，term ，range 等等</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#6A737D;"># 返回结果：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;took&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2157</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 查询花费时间，单位毫秒</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;timed_out&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 是否超时</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_shards&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 分片信息</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;total&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 总数</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;successful&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 成功</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;skipped&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 忽略</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;failed&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 失败 </span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;hits&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 搜索命中结果</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;total&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 搜索条件匹配的文档总数</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;value&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">5</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 总命中计数的值</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;relation&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;eq&quot;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 计数规则，eq 表示计数准确，gte 表示计数不准确</span></span>
<span class="line"><span style="color:#24292E;">            },</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;max_score&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1.0</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 匹配度分值</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;hits&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [...] </span><span style="color:#6A737D;"># 命中结果集合</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_4-2、匹配查询-match" tabindex="-1">4.2、匹配查询(match) <a class="header-anchor" href="#_4-2、匹配查询-match" aria-label="Permalink to &quot;4.2、匹配查询(match)&quot;">​</a></h5><p>  把查询条件进行分词，然后进行查询，多个词条之间是or的关系</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;match&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;name&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#F69D50;">&quot;zhangsan&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;match&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;name&quot;</span><span style="color:#005CC5;">:</span><span style="color:#6F42C1;">&quot;zhangsan&quot;</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_4-3、字段匹配查询-multi-match" tabindex="-1">4.3、字段匹配查询(multi_match) <a class="header-anchor" href="#_4-3、字段匹配查询-multi-match" aria-label="Permalink to &quot;4.3、字段匹配查询(multi_match)&quot;">​</a></h5><p>  可以在多个字段中查询</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;multi_match&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;zhangsan&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;fields&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> [</span><span style="color:#96D0FF;">&quot;name&quot;</span><span style="color:#ADBAC7;">,</span><span style="color:#96D0FF;">&quot;nickname&quot;</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;multi_match&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;zhangsan&quot;,</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;fields&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;nickname&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_4-4、关键字精确查询-term" tabindex="-1">4.4、关键字精确查询(term) <a class="header-anchor" href="#_4-4、关键字精确查询-term" aria-label="Permalink to &quot;4.4、关键字精确查询(term)&quot;">​</a></h5><p>  精确的关键词匹配查询，不对查询条件进行分词。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;term&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;name&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;value&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;zhangsan&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;term&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;name&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;value&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;zhangsan&quot;</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_4-5、多关键字精确查询-terms" tabindex="-1">4.5、多关键字精确查询(terms) <a class="header-anchor" href="#_4-5、多关键字精确查询-terms" aria-label="Permalink to &quot;4.5、多关键字精确查询(terms)&quot;">​</a></h5><p>  允许你指定多值进行匹配；如果这个字段包含了指定值中的任何一个值，那么这个文档满足条件，类似于mysql的in）</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;terms&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;name&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> [</span><span style="color:#96D0FF;">&quot;zhangsan&quot;</span><span style="color:#ADBAC7;">,</span><span style="color:#96D0FF;">&quot;lisi&quot;</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;terms&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;name&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span><span style="color:#032F62;">&quot;zhangsan&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;lisi&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_4-6、指定查询字段" tabindex="-1">4.6、指定查询字段 <a class="header-anchor" href="#_4-6、指定查询字段" aria-label="Permalink to &quot;4.6、指定查询字段&quot;">​</a></h5><p>  默认情况下，会把文档中保存在_source 的所有字段都返回。如果我们只想获取其中的部分字段，我们可以添加_source 的过滤</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;_source&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> [</span><span style="color:#96D0FF;">&quot;name&quot;</span><span style="color:#ADBAC7;">,</span><span style="color:#96D0FF;">&quot;nickname&quot;</span><span style="color:#ADBAC7;">],</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;terms&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;nickname&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> [</span><span style="color:#96D0FF;">&quot;zhangsan&quot;</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;_source&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;nickname&quot;</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;terms&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;nickname&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span><span style="color:#032F62;">&quot;zhangsan&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_4-7、过滤字段" tabindex="-1">4.7、过滤字段 <a class="header-anchor" href="#_4-7、过滤字段" aria-label="Permalink to &quot;4.7、过滤字段&quot;">​</a></h5><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;_source&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;excludes&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> [</span><span style="color:#96D0FF;">&quot;name&quot;</span><span style="color:#ADBAC7;">,</span><span style="color:#96D0FF;">&quot;nickname&quot;</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"><span style="color:#ADBAC7;">        },</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;terms&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;nickname&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> [</span><span style="color:#96D0FF;">&quot;zhangsan&quot;</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;_source&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;excludes&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;nickname&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;terms&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;nickname&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span><span style="color:#032F62;">&quot;zhangsan&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_4-8、组合查询-bool" tabindex="-1">4.8、组合查询(bool) <a class="header-anchor" href="#_4-8、组合查询-bool" aria-label="Permalink to &quot;4.8、组合查询(bool)&quot;">​</a></h5><p>  （<code>bool</code>把各种其它查询通过<code>must</code>（必须）、<code>must_not</code>（必须不）、<code>should</code>（应该）的方式进行组合）</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#ADBAC7;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;bool&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;must&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> [</span></span>
<span class="line"><span style="color:#ADBAC7;">                {</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;match&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                        </span><span style="color:#F69D50;">&quot;name&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;zhangsan&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">                    }</span></span>
<span class="line"><span style="color:#ADBAC7;">                }</span></span>
<span class="line"><span style="color:#ADBAC7;">            ],</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;must_not&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> [</span></span>
<span class="line"><span style="color:#ADBAC7;">                {</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;match&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                        </span><span style="color:#F69D50;">&quot;age&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;40&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">                    }</span></span>
<span class="line"><span style="color:#ADBAC7;">                }</span></span>
<span class="line"><span style="color:#ADBAC7;">            ],</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;should&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> [</span></span>
<span class="line"><span style="color:#ADBAC7;">                {</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;match&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                        </span><span style="color:#F69D50;">&quot;sex&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;男&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">                    }</span></span>
<span class="line"><span style="color:#ADBAC7;">                }</span></span>
<span class="line"><span style="color:#ADBAC7;">            ]</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;bool&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;must&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">                {</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;match&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#6F42C1;">&quot;name&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;zhangsan&quot;</span></span>
<span class="line"><span style="color:#24292E;">                    }</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            ],</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;must_not&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">                {</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;match&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#6F42C1;">&quot;age&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;40&quot;</span></span>
<span class="line"><span style="color:#24292E;">                    }</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            ],</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;should&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">                {</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;match&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#6F42C1;">&quot;sex&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;男&quot;</span></span>
<span class="line"><span style="color:#24292E;">                    }</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            ]</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="_4-9、范围查询-range" tabindex="-1">4.9、范围查询(range) <a class="header-anchor" href="#_4-9、范围查询-range" aria-label="Permalink to &quot;4.9、范围查询(range)&quot;">​</a></h5><p>  查询找出那些落在指定区间内的数字或者时间</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;range&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;age&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;gte&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">30</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;lte&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">35</span></span>
<span class="line"><span style="color:#ADBAC7;">                }</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;range&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;age&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;gte&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">30</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;lte&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">35</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_4-10、模糊查询" tabindex="-1">4.10、模糊查询 <a class="header-anchor" href="#_4-10、模糊查询" aria-label="Permalink to &quot;4.10、模糊查询&quot;">​</a></h5><p>  返回包含与搜索字词相似的字词的文档</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;fuzzy&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;title&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;value&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;zhangsan&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;fuzziness&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 编辑距离</span></span>
<span class="line"><span style="color:#ADBAC7;">                }</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span>
<span class="line"><span style="color:#768390;"># 编辑距离是将一个术语转换为另一个术语所需的一个字符更改的次数。这些更改可以包括：</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">更改字符（box</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">→</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">fox）</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">删除字符（black</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">→</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">lack）</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">插入字符（sic</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">→</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">sick）</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">转置两个相邻字符（act</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">→</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">cat）</span></span>
<span class="line"><span style="color:#768390;"># 为了找到相似的术语，fuzzy查询会在指定的编辑距离内创建一组搜索词的所有可能的变体或扩展。然后查询返回每个扩展的完全匹配。</span></span>
<span class="line"><span style="color:#768390;"># 通过 fuzziness 修改编辑距离。一般使用默认值 AUTO，根据术语的长度生成编辑距离。</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;fuzzy&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;title&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;value&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;zhangsan&quot;,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;fuzziness&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 编辑距离</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#6A737D;"># 编辑距离是将一个术语转换为另一个术语所需的一个字符更改的次数。这些更改可以包括：</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">更改字符（box</span><span style="color:#24292E;"> </span><span style="color:#032F62;">→</span><span style="color:#24292E;"> </span><span style="color:#032F62;">fox）</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">删除字符（black</span><span style="color:#24292E;"> </span><span style="color:#032F62;">→</span><span style="color:#24292E;"> </span><span style="color:#032F62;">lack）</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">插入字符（sic</span><span style="color:#24292E;"> </span><span style="color:#032F62;">→</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sick）</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">转置两个相邻字符（act</span><span style="color:#24292E;"> </span><span style="color:#032F62;">→</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cat）</span></span>
<span class="line"><span style="color:#6A737D;"># 为了找到相似的术语，fuzzy查询会在指定的编辑距离内创建一组搜索词的所有可能的变体或扩展。然后查询返回每个扩展的完全匹配。</span></span>
<span class="line"><span style="color:#6A737D;"># 通过 fuzziness 修改编辑距离。一般使用默认值 AUTO，根据术语的长度生成编辑距离。</span></span></code></pre></div><h5 id="_4-11、单字段排序-sort" tabindex="-1">4.11、单字段排序(sort) <a class="header-anchor" href="#_4-11、单字段排序-sort" aria-label="Permalink to &quot;4.11、单字段排序(sort)&quot;">​</a></h5><p>  可以让我们按照不同的字段进行排序，并且通过 order指定排序的方式</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;match&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;name&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#F69D50;">&quot;zhangsan&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        },</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;sort&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> [{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;age&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;order&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#F69D50;">&quot;desc&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }]</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;match&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;name&quot;</span><span style="color:#005CC5;">:</span><span style="color:#6F42C1;">&quot;zhangsan&quot;</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;sort&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;age&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;order&quot;</span><span style="color:#005CC5;">:</span><span style="color:#6F42C1;">&quot;desc&quot;</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }]</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_4-12、多字段排序" tabindex="-1">4.12、多字段排序 <a class="header-anchor" href="#_4-12、多字段排序" aria-label="Permalink to &quot;4.12、多字段排序&quot;">​</a></h5><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;match_all&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{}</span></span>
<span class="line"><span style="color:#ADBAC7;">        },</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;sort&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> [</span></span>
<span class="line"><span style="color:#ADBAC7;">            {</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;age&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;order&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;desc&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">                }</span></span>
<span class="line"><span style="color:#ADBAC7;">            },</span></span>
<span class="line"><span style="color:#ADBAC7;">            {</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;_score&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;order&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;desc&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">                }</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        ]</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;match_all&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{}</span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;sort&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">            {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;age&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;order&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;desc&quot;</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            },</span></span>
<span class="line"><span style="color:#24292E;">            {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;_score&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;order&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;desc&quot;</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        ]</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_4-13、高亮查询" tabindex="-1">4.13、高亮查询 <a class="header-anchor" href="#_4-13、高亮查询" aria-label="Permalink to &quot;4.13、高亮查询&quot;">​</a></h5><p>  对查询内容中的关键字部分，进行标签和样式(高亮)的设置</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;match&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;name&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;zhangsan&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        },</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;highlight&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;pre_tags&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;&lt;font color=&#39;red&#39;&gt;&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 前置标签</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;post_tags&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;&lt;/font&gt;&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;">#后置标签</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;fields&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 需要高亮的字段</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;name&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{}</span><span style="color:#ADBAC7;"> </span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;match&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;name&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;zhangsan&quot;</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;highlight&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;pre_tags&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;font color=&#39;red&#39;&gt;&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 前置标签</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;post_tags&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;/font&gt;&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#后置标签</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;fields&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 需要高亮的字段</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;name&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{}</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_4-14、分页查询" tabindex="-1">4.14、分页查询 <a class="header-anchor" href="#_4-14、分页查询" aria-label="Permalink to &quot;4.14、分页查询&quot;">​</a></h5><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;match_all&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{}</span></span>
<span class="line"><span style="color:#ADBAC7;">        },</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;sort&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> [</span></span>
<span class="line"><span style="color:#ADBAC7;">            {</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;age&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;order&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;desc&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">                }</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        ],</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;from&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 当前页的起始索引，默认从 0 开始。 from = (pageNum - 1) * size</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;size&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">  </span><span style="color:#768390;"># 每页显示多少条</span></span>
<span class="line"><span style="color:#ADBAC7;">    }   </span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;"># 在集群系统中深度分页：</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">在一个有5个主分片的索引中搜索。当我们请求结果的第一页（结果1到10）时，每个分片产生自己最顶端10个结果然后返回它们</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">给请求节点(requesting</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">node</span><span style="color:#ADBAC7;">)，它再排序这所有的50个结果以选出顶端的10个结果。现在假设我们请求第1000页——结果10001到10010。</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">工作方式都相同，不同的是每个分片都必须产生顶端的10010个结果。然后请求节点排序这50050个结果并丢弃50040个！</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;match_all&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{}</span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;sort&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">            {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;age&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;order&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;desc&quot;</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        ],</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;from&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 当前页的起始索引，默认从 0 开始。 from = (pageNum - 1) * size</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;size&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># 每页显示多少条</span></span>
<span class="line"><span style="color:#24292E;">    }   </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 在集群系统中深度分页：</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">在一个有5个主分片的索引中搜索。当我们请求结果的第一页（结果1到10）时，每个分片产生自己最顶端10个结果然后返回它们</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">给请求节点(requesting</span><span style="color:#24292E;"> </span><span style="color:#032F62;">node</span><span style="color:#24292E;">)，它再排序这所有的50个结果以选出顶端的10个结果。现在假设我们请求第1000页——结果10001到10010。</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">工作方式都相同，不同的是每个分片都必须产生顶端的10010个结果。然后请求节点排序这50050个结果并丢弃50040个！</span></span></code></pre></div><h5 id="_4-15、聚合查询" tabindex="-1">4.15、聚合查询 <a class="header-anchor" href="#_4-15、聚合查询" aria-label="Permalink to &quot;4.15、聚合查询&quot;">​</a></h5><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;aggs&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;max_age&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;">{ </span><span style="color:#768390;"># 名称</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;max&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;">{&quot;</span><span style="color:#F69D50;">field</span><span style="color:#F69D50;">&quot;:&quot;</span><span style="color:#F69D50;">age</span><span style="color:#F69D50;">&quot;} # max：最大值</span></span>
<span class="line"><span style="color:#F69D50;">            },</span></span>
<span class="line"><span style="color:#F69D50;">            &quot;</span><span style="color:#F69D50;">min_age</span><span style="color:#F69D50;">&quot;:{ # 名称</span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">min</span><span style="color:#F69D50;">&quot;:{&quot;</span><span style="color:#F69D50;">field</span><span style="color:#F69D50;">&quot;:&quot;</span><span style="color:#F69D50;">age</span><span style="color:#F69D50;">&quot;} # min：最小值</span></span>
<span class="line"><span style="color:#F69D50;">            },</span></span>
<span class="line"><span style="color:#F69D50;">            &quot;</span><span style="color:#F69D50;">sum_age</span><span style="color:#F69D50;">&quot;:{</span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">sum</span><span style="color:#F69D50;">&quot;:{&quot;</span><span style="color:#F69D50;">field</span><span style="color:#F69D50;">&quot;:&quot;</span><span style="color:#F69D50;">age</span><span style="color:#F69D50;">&quot;} # sum：求和</span></span>
<span class="line"><span style="color:#F69D50;">            },</span></span>
<span class="line"><span style="color:#F69D50;">            &quot;</span><span style="color:#F69D50;">avg_age</span><span style="color:#F69D50;">&quot;:{</span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">avg</span><span style="color:#F69D50;">&quot;:{&quot;</span><span style="color:#F69D50;">field</span><span style="color:#F69D50;">&quot;:&quot;</span><span style="color:#F69D50;">age</span><span style="color:#F69D50;">&quot;} # avg：平均值</span></span>
<span class="line"><span style="color:#F69D50;">            },</span></span>
<span class="line"><span style="color:#F69D50;">            &quot;</span><span style="color:#F69D50;">distinct_age</span><span style="color:#F69D50;">&quot;:{</span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">cardinality</span><span style="color:#F69D50;">&quot;:{  # 去重后再去总数</span></span>
<span class="line"><span style="color:#F69D50;">                    &quot;</span><span style="color:#F69D50;">field</span><span style="color:#F69D50;">&quot;:&quot;</span><span style="color:#F69D50;">age</span><span style="color:#F69D50;">&quot;</span></span>
<span class="line"><span style="color:#F69D50;">                }</span></span>
<span class="line"><span style="color:#F69D50;">            },</span></span>
<span class="line"><span style="color:#F69D50;">            &quot;</span><span style="color:#F69D50;">stats_age</span><span style="color:#F69D50;">&quot;:{</span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">stats</span><span style="color:#F69D50;">&quot;:{&quot;</span><span style="color:#F69D50;">field</span><span style="color:#F69D50;">&quot;:&quot;</span><span style="color:#F69D50;">age</span><span style="color:#F69D50;">&quot;} # stats 聚合，对某个字段一次性返回 count，max，min，avg 和 sum 五个指标</span></span>
<span class="line"><span style="color:#F69D50;">            }</span></span>
<span class="line"><span style="color:#F69D50;">        },</span></span>
<span class="line"><span style="color:#F69D50;">        &quot;</span><span style="color:#F69D50;">size</span><span style="color:#F69D50;">&quot;:0 # 不显示原数据</span></span>
<span class="line"><span style="color:#F69D50;">    } </span></span>
<span class="line"><span style="color:#F69D50;">        </span></span>
<span class="line"><span style="color:#F69D50;"># 划分范围 histogram</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#F69D50;">    {</span></span>
<span class="line"><span style="color:#F69D50;">        &quot;</span><span style="color:#F69D50;">size</span><span style="color:#F69D50;">&quot; : 0,</span></span>
<span class="line"><span style="color:#F69D50;">        &quot;</span><span style="color:#F69D50;">aggs</span><span style="color:#F69D50;">&quot;:{</span></span>
<span class="line"><span style="color:#F69D50;">            &quot;</span><span style="color:#F69D50;">price</span><span style="color:#F69D50;">&quot;:{</span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">histogram</span><span style="color:#F69D50;">&quot;:{ </span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">field</span><span style="color:#F69D50;">&quot;: &quot;</span><span style="color:#F69D50;">price</span><span style="color:#F69D50;">&quot;,</span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">interval</span><span style="color:#F69D50;">&quot;: 2000 # interval：2000，划分范围，0~2000，2000~4000，4000~6000，6000~8000，8000~10000</span></span>
<span class="line"><span style="color:#F69D50;">                }</span></span>
<span class="line"><span style="color:#F69D50;">            }</span></span>
<span class="line"><span style="color:#F69D50;">        }</span></span>
<span class="line"><span style="color:#F69D50;">    }</span></span>
<span class="line"><span style="color:#F69D50;">            </span></span>
<span class="line"><span style="color:#F69D50;"># 按照日期分组聚合date_histogram</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#F69D50;">    {</span></span>
<span class="line"><span style="color:#F69D50;">        &quot;</span><span style="color:#F69D50;">size</span><span style="color:#F69D50;">&quot; : 0,</span></span>
<span class="line"><span style="color:#F69D50;">        &quot;</span><span style="color:#F69D50;">aggs</span><span style="color:#F69D50;">&quot;: {</span></span>
<span class="line"><span style="color:#F69D50;">            &quot;</span><span style="color:#F69D50;">sales</span><span style="color:#F69D50;">&quot;: {</span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">date_histogram</span><span style="color:#F69D50;">&quot;: {</span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">field</span><span style="color:#F69D50;">&quot;: &quot;</span><span style="color:#F69D50;">sold_date</span><span style="color:#F69D50;">&quot;,</span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">interval</span><span style="color:#F69D50;">&quot;: &quot;</span><span style="color:#F69D50;">month</span><span style="color:#F69D50;">&quot;, </span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">format</span><span style="color:#F69D50;">&quot;: &quot;</span><span style="color:#F69D50;">yyyy-MM-dd</span><span style="color:#F69D50;">&quot;,</span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">min_doc_count</span><span style="color:#F69D50;">&quot; : 0,  # 一条数据都没有，那么这个区间也是要返回的，不然默认是会过滤掉这个区间的</span></span>
<span class="line"><span style="color:#F69D50;">                &quot;</span><span style="color:#F69D50;">extended_bounds</span><span style="color:#F69D50;">&quot; : { </span></span>
<span class="line"><span style="color:#F69D50;">                    &quot;</span><span style="color:#F69D50;">min</span><span style="color:#F69D50;">&quot; : &quot;</span><span style="color:#F69D50;">2019-01-01</span><span style="color:#F69D50;">&quot;, # 起始日期</span></span>
<span class="line"><span style="color:#F69D50;">                    &quot;</span><span style="color:#F69D50;">max</span><span style="color:#F69D50;">&quot; : &quot;</span><span style="color:#F69D50;">2020-12-31</span><span style="color:#F69D50;">&quot;  # 截止日期</span></span>
<span class="line"><span style="color:#F69D50;">                }</span></span>
<span class="line"><span style="color:#F69D50;">                }</span></span>
<span class="line"><span style="color:#F69D50;">            }</span></span>
<span class="line"><span style="color:#F69D50;">        }</span></span>
<span class="line"><span style="color:#F69D50;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;aggs&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;max_age&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;">{ </span><span style="color:#6A737D;"># 名称</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;max&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;">{&quot;</span><span style="color:#6F42C1;">field</span><span style="color:#6F42C1;">&quot;:&quot;</span><span style="color:#6F42C1;">age</span><span style="color:#6F42C1;">&quot;} # max：最大值</span></span>
<span class="line"><span style="color:#6F42C1;">            },</span></span>
<span class="line"><span style="color:#6F42C1;">            &quot;</span><span style="color:#6F42C1;">min_age</span><span style="color:#6F42C1;">&quot;:{ # 名称</span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">min</span><span style="color:#6F42C1;">&quot;:{&quot;</span><span style="color:#6F42C1;">field</span><span style="color:#6F42C1;">&quot;:&quot;</span><span style="color:#6F42C1;">age</span><span style="color:#6F42C1;">&quot;} # min：最小值</span></span>
<span class="line"><span style="color:#6F42C1;">            },</span></span>
<span class="line"><span style="color:#6F42C1;">            &quot;</span><span style="color:#6F42C1;">sum_age</span><span style="color:#6F42C1;">&quot;:{</span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">sum</span><span style="color:#6F42C1;">&quot;:{&quot;</span><span style="color:#6F42C1;">field</span><span style="color:#6F42C1;">&quot;:&quot;</span><span style="color:#6F42C1;">age</span><span style="color:#6F42C1;">&quot;} # sum：求和</span></span>
<span class="line"><span style="color:#6F42C1;">            },</span></span>
<span class="line"><span style="color:#6F42C1;">            &quot;</span><span style="color:#6F42C1;">avg_age</span><span style="color:#6F42C1;">&quot;:{</span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">avg</span><span style="color:#6F42C1;">&quot;:{&quot;</span><span style="color:#6F42C1;">field</span><span style="color:#6F42C1;">&quot;:&quot;</span><span style="color:#6F42C1;">age</span><span style="color:#6F42C1;">&quot;} # avg：平均值</span></span>
<span class="line"><span style="color:#6F42C1;">            },</span></span>
<span class="line"><span style="color:#6F42C1;">            &quot;</span><span style="color:#6F42C1;">distinct_age</span><span style="color:#6F42C1;">&quot;:{</span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">cardinality</span><span style="color:#6F42C1;">&quot;:{  # 去重后再去总数</span></span>
<span class="line"><span style="color:#6F42C1;">                    &quot;</span><span style="color:#6F42C1;">field</span><span style="color:#6F42C1;">&quot;:&quot;</span><span style="color:#6F42C1;">age</span><span style="color:#6F42C1;">&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">                }</span></span>
<span class="line"><span style="color:#6F42C1;">            },</span></span>
<span class="line"><span style="color:#6F42C1;">            &quot;</span><span style="color:#6F42C1;">stats_age</span><span style="color:#6F42C1;">&quot;:{</span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">stats</span><span style="color:#6F42C1;">&quot;:{&quot;</span><span style="color:#6F42C1;">field</span><span style="color:#6F42C1;">&quot;:&quot;</span><span style="color:#6F42C1;">age</span><span style="color:#6F42C1;">&quot;} # stats 聚合，对某个字段一次性返回 count，max，min，avg 和 sum 五个指标</span></span>
<span class="line"><span style="color:#6F42C1;">            }</span></span>
<span class="line"><span style="color:#6F42C1;">        },</span></span>
<span class="line"><span style="color:#6F42C1;">        &quot;</span><span style="color:#6F42C1;">size</span><span style="color:#6F42C1;">&quot;:0 # 不显示原数据</span></span>
<span class="line"><span style="color:#6F42C1;">    } </span></span>
<span class="line"><span style="color:#6F42C1;">        </span></span>
<span class="line"><span style="color:#6F42C1;"># 划分范围 histogram</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#6F42C1;">    {</span></span>
<span class="line"><span style="color:#6F42C1;">        &quot;</span><span style="color:#6F42C1;">size</span><span style="color:#6F42C1;">&quot; : 0,</span></span>
<span class="line"><span style="color:#6F42C1;">        &quot;</span><span style="color:#6F42C1;">aggs</span><span style="color:#6F42C1;">&quot;:{</span></span>
<span class="line"><span style="color:#6F42C1;">            &quot;</span><span style="color:#6F42C1;">price</span><span style="color:#6F42C1;">&quot;:{</span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">histogram</span><span style="color:#6F42C1;">&quot;:{ </span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">field</span><span style="color:#6F42C1;">&quot;: &quot;</span><span style="color:#6F42C1;">price</span><span style="color:#6F42C1;">&quot;,</span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">interval</span><span style="color:#6F42C1;">&quot;: 2000 # interval：2000，划分范围，0~2000，2000~4000，4000~6000，6000~8000，8000~10000</span></span>
<span class="line"><span style="color:#6F42C1;">                }</span></span>
<span class="line"><span style="color:#6F42C1;">            }</span></span>
<span class="line"><span style="color:#6F42C1;">        }</span></span>
<span class="line"><span style="color:#6F42C1;">    }</span></span>
<span class="line"><span style="color:#6F42C1;">            </span></span>
<span class="line"><span style="color:#6F42C1;"># 按照日期分组聚合date_histogram</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#6F42C1;">    {</span></span>
<span class="line"><span style="color:#6F42C1;">        &quot;</span><span style="color:#6F42C1;">size</span><span style="color:#6F42C1;">&quot; : 0,</span></span>
<span class="line"><span style="color:#6F42C1;">        &quot;</span><span style="color:#6F42C1;">aggs</span><span style="color:#6F42C1;">&quot;: {</span></span>
<span class="line"><span style="color:#6F42C1;">            &quot;</span><span style="color:#6F42C1;">sales</span><span style="color:#6F42C1;">&quot;: {</span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">date_histogram</span><span style="color:#6F42C1;">&quot;: {</span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">field</span><span style="color:#6F42C1;">&quot;: &quot;</span><span style="color:#6F42C1;">sold_date</span><span style="color:#6F42C1;">&quot;,</span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">interval</span><span style="color:#6F42C1;">&quot;: &quot;</span><span style="color:#6F42C1;">month</span><span style="color:#6F42C1;">&quot;, </span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">format</span><span style="color:#6F42C1;">&quot;: &quot;</span><span style="color:#6F42C1;">yyyy-MM-dd</span><span style="color:#6F42C1;">&quot;,</span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">min_doc_count</span><span style="color:#6F42C1;">&quot; : 0,  # 一条数据都没有，那么这个区间也是要返回的，不然默认是会过滤掉这个区间的</span></span>
<span class="line"><span style="color:#6F42C1;">                &quot;</span><span style="color:#6F42C1;">extended_bounds</span><span style="color:#6F42C1;">&quot; : { </span></span>
<span class="line"><span style="color:#6F42C1;">                    &quot;</span><span style="color:#6F42C1;">min</span><span style="color:#6F42C1;">&quot; : &quot;</span><span style="color:#6F42C1;">2019-01-01</span><span style="color:#6F42C1;">&quot;, # 起始日期</span></span>
<span class="line"><span style="color:#6F42C1;">                    &quot;</span><span style="color:#6F42C1;">max</span><span style="color:#6F42C1;">&quot; : &quot;</span><span style="color:#6F42C1;">2020-12-31</span><span style="color:#6F42C1;">&quot;  # 截止日期</span></span>
<span class="line"><span style="color:#6F42C1;">                }</span></span>
<span class="line"><span style="color:#6F42C1;">                }</span></span>
<span class="line"><span style="color:#6F42C1;">            }</span></span>
<span class="line"><span style="color:#6F42C1;">        }</span></span>
<span class="line"><span style="color:#6F42C1;">    }</span></span></code></pre></div><h5 id="_4-16、桶聚合查询" tabindex="-1">4.16、桶聚合查询 <a class="header-anchor" href="#_4-16、桶聚合查询" aria-label="Permalink to &quot;4.16、桶聚合查询&quot;">​</a></h5><p>  相当于sql中的group by语句</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">：http://127.0.0.1:9200/student/_search</span><span style="color:#ADBAC7;">    </span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;aggs&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;age_groupby&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;terms&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                    </span><span style="color:#F69D50;">&quot;field&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#F69D50;">&quot;age&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">                }</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        },</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;size&quot;</span><span style="color:#F69D50;">:0</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求</span><span style="color:#24292E;"> </span><span style="color:#032F62;">：http://127.0.0.1:9200/student/_search</span><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;aggs&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;age_groupby&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;terms&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">&quot;field&quot;</span><span style="color:#005CC5;">:</span><span style="color:#6F42C1;">&quot;age&quot;</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;size&quot;</span><span style="color:#6F42C1;">:0</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h5 id="_4-17、exists查询" tabindex="-1">4.17、exists查询 <a class="header-anchor" href="#_4-17、exists查询" aria-label="Permalink to &quot;4.17、exists查询&quot;">​</a></h5><p>可以用于查找文档中是否包含指定字段或没有某个字段，类似于SQL语句中的IS_NULL条件</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;exists&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;field&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;title&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求：http://127.0.0.1:9200/student/_search</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;exists&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;field&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;title&quot;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h4 id="_5、定位错误语法" tabindex="-1">5、定位错误语法 <a class="header-anchor" href="#_5、定位错误语法" aria-label="Permalink to &quot;5、定位错误语法&quot;">​</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求：</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">http://127.0.0.1:9200/book/_validate/query?explain</span></span>
<span class="line"><span style="color:#F69D50;">请求体：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;mach&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;description&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;java程序员&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求：</span><span style="color:#24292E;"> </span><span style="color:#032F62;">http://127.0.0.1:9200/book/_validate/query?explain</span></span>
<span class="line"><span style="color:#6F42C1;">请求体：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;mach&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;description&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;java程序员&quot;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h4 id="_6、查看集群状态" tabindex="-1">6、查看集群状态 <a class="header-anchor" href="#_6、查看集群状态" aria-label="Permalink to &quot;6、查看集群状态&quot;">​</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">GET</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">请求：</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">http://127.0.0.1:1003/_cluster/health</span></span>
<span class="line"><span style="color:#F69D50;">返回内容：</span></span>
<span class="line"><span style="color:#ADBAC7;">    {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;cluster_name&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;my-elasticsearch&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;status&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;green&quot;,</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># status字段表示当前集群在总体上是否工作正常。</span></span>
<span class="line"><span style="color:#ADBAC7;">                            </span><span style="color:#768390;"># green:  所有的主分片和副本分片都正常运行。</span></span>
<span class="line"><span style="color:#ADBAC7;">                            </span><span style="color:#768390;"># yellow: 所有的主分片都正常运行，但不是所有的副本分片都正常运行。</span></span>
<span class="line"><span style="color:#ADBAC7;">                            </span><span style="color:#768390;"># red:    有主分片没能正常运行。</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;timed_out&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">false</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;number_of_nodes&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">3</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;number_of_data_nodes&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">3</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;active_primary_shards&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;active_shards&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;relocating_shards&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;initializing_shards&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;unassigned_shards&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;delayed_unassigned_shards&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;number_of_pending_tasks&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;number_of_in_flight_fetch&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;task_max_waiting_in_queue_millis&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;active_shards_percent_as_number&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">100.0</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">GET</span><span style="color:#24292E;"> </span><span style="color:#032F62;">请求：</span><span style="color:#24292E;"> </span><span style="color:#032F62;">http://127.0.0.1:1003/_cluster/health</span></span>
<span class="line"><span style="color:#6F42C1;">返回内容：</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;cluster_name&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;my-elasticsearch&quot;,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;status&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;green&quot;,</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># status字段表示当前集群在总体上是否工作正常。</span></span>
<span class="line"><span style="color:#24292E;">                            </span><span style="color:#6A737D;"># green:  所有的主分片和副本分片都正常运行。</span></span>
<span class="line"><span style="color:#24292E;">                            </span><span style="color:#6A737D;"># yellow: 所有的主分片都正常运行，但不是所有的副本分片都正常运行。</span></span>
<span class="line"><span style="color:#24292E;">                            </span><span style="color:#6A737D;"># red:    有主分片没能正常运行。</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;timed_out&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;number_of_nodes&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;number_of_data_nodes&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;active_primary_shards&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;active_shards&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;relocating_shards&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;initializing_shards&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;unassigned_shards&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;delayed_unassigned_shards&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;number_of_pending_tasks&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;number_of_in_flight_fetch&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;task_max_waiting_in_queue_millis&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;active_shards_percent_as_number&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100.0</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><h3 id="es的java-api操作-7-8-0" tabindex="-1">es的Java api操作（7.8.0） <a class="header-anchor" href="#es的java-api操作-7-8-0" aria-label="Permalink to &quot;es的Java api操作（7.8.0）&quot;">​</a></h3><h4 id="_1、创建及关闭客户端连接" tabindex="-1">1、创建及关闭客户端连接 <a class="header-anchor" href="#_1、创建及关闭客户端连接" aria-label="Permalink to &quot;1、创建及关闭客户端连接&quot;">​</a></h4><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 创建客户端对象 （9200 端口为 Elasticsearch 的 Web 通信端口，localhost 为启动 ES 服务的主机名）</span></span>
<span class="line"><span style="color:#ADBAC7;">RestHighLevelClient</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">client</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">RestHighLevelClient</span><span style="color:#ADBAC7;">(RestClient.</span><span style="color:#DCBDFB;">builder</span><span style="color:#ADBAC7;">(</span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">HttpHost</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;localhost&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">9200</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;http&quot;</span><span style="color:#ADBAC7;">)));</span></span>
<span class="line"><span style="color:#768390;">// 关闭客户端连接</span></span>
<span class="line"><span style="color:#ADBAC7;">client.</span><span style="color:#DCBDFB;">close</span><span style="color:#ADBAC7;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 创建客户端对象 （9200 端口为 Elasticsearch 的 Web 通信端口，localhost 为启动 ES 服务的主机名）</span></span>
<span class="line"><span style="color:#24292E;">RestHighLevelClient client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RestHighLevelClient</span><span style="color:#24292E;">(RestClient.</span><span style="color:#6F42C1;">builder</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HttpHost</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;localhost&quot;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">9200</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;http&quot;</span><span style="color:#24292E;">)));</span></span>
<span class="line"><span style="color:#6A737D;">// 关闭客户端连接</span></span>
<span class="line"><span style="color:#24292E;">client.</span><span style="color:#6F42C1;">close</span><span style="color:#24292E;">();</span></span></code></pre></div><h4 id="_2、索引操作" tabindex="-1">2、索引操作 <a class="header-anchor" href="#_2、索引操作" aria-label="Permalink to &quot;2、索引操作&quot;">​</a></h4><h5 id="_2-1、创建索引" tabindex="-1">2.1、创建索引 <a class="header-anchor" href="#_2-1、创建索引" aria-label="Permalink to &quot;2.1、创建索引&quot;">​</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 创建索引 - 请求对象</span></span>
<span class="line"><span style="color:#ADBAC7;">CreateIndexRequest</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">request</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">CreateIndexRequest</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;user&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#768390;">//设置参数</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">settings</span><span style="color:#ADBAC7;">(Settings.</span><span style="color:#DCBDFB;">builder</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">put</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;number_of_shards&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;1&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">put</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;number_of_replicas&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;0&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"><span style="color:#768390;">//设置别名</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">alias</span><span style="color:#ADBAC7;">(</span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">Alias</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;itheima_index_new&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">// 发送请求，获取响应(同步)</span></span>
<span class="line"><span style="color:#ADBAC7;">CreateIndexResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">indices</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">create</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span>
<span class="line"><span style="color:#768390;">// 异步</span></span>
<span class="line"><span style="color:#768390;">//监听方法</span></span>
<span class="line"><span style="color:#ADBAC7;">ActionListener</span><span style="color:#F69D50;">&lt;</span><span style="color:#F47067;">CreateIndexResponse</span><span style="color:#F69D50;">&gt; </span><span style="color:#ADBAC7;">listener</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> ActionListener&lt;</span><span style="color:#F47067;">CreateIndexResponse</span><span style="color:#ADBAC7;">&gt;() {    </span></span>
<span class="line"><span style="color:#ADBAC7;">    @</span><span style="color:#F47067;">Override</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">public</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">void</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">onResponse</span><span style="color:#ADBAC7;">(CreateIndexResponse </span><span style="color:#F69D50;">createIndexResponse</span><span style="color:#ADBAC7;">) {</span></span>
<span class="line"><span style="color:#ADBAC7;">        System.out.</span><span style="color:#DCBDFB;">println</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;!!!!!!!!创建索引成功&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#ADBAC7;">        System.out.</span><span style="color:#DCBDFB;">println</span><span style="color:#ADBAC7;">(createIndexResponse.</span><span style="color:#DCBDFB;">toString</span><span style="color:#ADBAC7;">());</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span>
<span class="line"><span style="color:#ADBAC7;">    @</span><span style="color:#F47067;">Override</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">public</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">void</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">onFailure</span><span style="color:#ADBAC7;">(Exception </span><span style="color:#F69D50;">e</span><span style="color:#ADBAC7;">) {</span></span>
<span class="line"><span style="color:#ADBAC7;">        System.out.</span><span style="color:#DCBDFB;">println</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;!!!!!!!!创建索引失败&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#ADBAC7;">        e.</span><span style="color:#DCBDFB;">printStackTrace</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span>
<span class="line"><span style="color:#ADBAC7;">};</span></span>
<span class="line"><span style="color:#768390;">//执行创建索引库</span></span>
<span class="line"><span style="color:#ADBAC7;">CreateIndexResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">indices</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">createAsync</span><span style="color:#ADBAC7;">(createIndexRequest, RequestOptions.DEFAULT, listener);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 创建索引 - 请求对象</span></span>
<span class="line"><span style="color:#24292E;">CreateIndexRequest request </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">CreateIndexRequest</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">//设置参数</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">settings</span><span style="color:#24292E;">(Settings.</span><span style="color:#6F42C1;">builder</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;number_of_shards&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;1&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;number_of_replicas&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;0&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#6A737D;">//设置别名</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">alias</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Alias</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;itheima_index_new&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 发送请求，获取响应(同步)</span></span>
<span class="line"><span style="color:#24292E;">CreateIndexResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">indices</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span>
<span class="line"><span style="color:#6A737D;">// 异步</span></span>
<span class="line"><span style="color:#6A737D;">//监听方法</span></span>
<span class="line"><span style="color:#24292E;">ActionListener&lt;</span><span style="color:#D73A49;">CreateIndexResponse</span><span style="color:#24292E;">&gt; listener </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> ActionListener&lt;</span><span style="color:#D73A49;">CreateIndexResponse</span><span style="color:#24292E;">&gt;() {    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onResponse</span><span style="color:#24292E;">(CreateIndexResponse </span><span style="color:#E36209;">createIndexResponse</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;!!!!!!!!创建索引成功&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(createIndexResponse.</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onFailure</span><span style="color:#24292E;">(Exception </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;!!!!!!!!创建索引失败&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"><span style="color:#6A737D;">//执行创建索引库</span></span>
<span class="line"><span style="color:#24292E;">CreateIndexResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">indices</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">createAsync</span><span style="color:#24292E;">(createIndexRequest, RequestOptions.DEFAULT, listener);</span></span></code></pre></div><h5 id="_2-2、查看索引" tabindex="-1">2.2、查看索引 <a class="header-anchor" href="#_2-2、查看索引" aria-label="Permalink to &quot;2.2、查看索引&quot;">​</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 查询索引 - 请求对象</span></span>
<span class="line"><span style="color:#ADBAC7;">GetIndexRequest</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">request</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">GetIndexRequest</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;user&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#768390;">// 发送请求，获取响应</span></span>
<span class="line"><span style="color:#ADBAC7;">GetIndexResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">indices</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">get</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 查询索引 - 请求对象</span></span>
<span class="line"><span style="color:#24292E;">GetIndexRequest request </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">GetIndexRequest</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 发送请求，获取响应</span></span>
<span class="line"><span style="color:#24292E;">GetIndexResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">indices</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h5 id="_2-3、删除索引" tabindex="-1">2.3、删除索引 <a class="header-anchor" href="#_2-3、删除索引" aria-label="Permalink to &quot;2.3、删除索引&quot;">​</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 删除索引 - 请求对象</span></span>
<span class="line"><span style="color:#ADBAC7;">DeleteIndexRequest</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">request</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">DeleteIndexRequest</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;user&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#768390;">// 发送请求，获取响应</span></span>
<span class="line"><span style="color:#ADBAC7;">AcknowledgedResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">indices</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">delete</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 删除索引 - 请求对象</span></span>
<span class="line"><span style="color:#24292E;">DeleteIndexRequest request </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeleteIndexRequest</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 发送请求，获取响应</span></span>
<span class="line"><span style="color:#24292E;">AcknowledgedResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">indices</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h4 id="_3、文档操作" tabindex="-1">3、文档操作 <a class="header-anchor" href="#_3、文档操作" aria-label="Permalink to &quot;3、文档操作&quot;">​</a></h4><h5 id="_3-1、新增文档" tabindex="-1">3.1、新增文档 <a class="header-anchor" href="#_3-1、新增文档" aria-label="Permalink to &quot;3.1、新增文档&quot;">​</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 新增文档 - 请求对象</span></span>
<span class="line"><span style="color:#ADBAC7;">IndexRequest</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">request</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">IndexRequest</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#768390;">// 设置索引及唯一性标识</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">index</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;user&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">id</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;1001&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">// 创建数据对象</span></span>
<span class="line"><span style="color:#ADBAC7;">User</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">user</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">User</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">user.</span><span style="color:#DCBDFB;">setName</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;zhangsan&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#ADBAC7;">user.</span><span style="color:#DCBDFB;">setAge</span><span style="color:#ADBAC7;">(</span><span style="color:#6CB6FF;">30</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#ADBAC7;">user.</span><span style="color:#DCBDFB;">setSex</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;男&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#ADBAC7;">ObjectMapper</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">objectMapper</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">ObjectMapper</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">String</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">productJson</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> objectMapper.</span><span style="color:#DCBDFB;">writeValueAsString</span><span style="color:#ADBAC7;">(user);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">// 添加文档数据，数据格式为 JSON 格式</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(productJson,XContentType.JSON);</span></span>
<span class="line"><span style="color:#768390;">// 客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#ADBAC7;">IndexResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">index</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 新增文档 - 请求对象</span></span>
<span class="line"><span style="color:#24292E;">IndexRequest request </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IndexRequest</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#6A737D;">// 设置索引及唯一性标识</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">index</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;1001&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 创建数据对象</span></span>
<span class="line"><span style="color:#24292E;">User user </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">User</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">user.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;zhangsan&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">user.</span><span style="color:#6F42C1;">setAge</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">30</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">user.</span><span style="color:#6F42C1;">setSex</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;男&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">ObjectMapper objectMapper </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ObjectMapper</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">String productJson </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> objectMapper.</span><span style="color:#6F42C1;">writeValueAsString</span><span style="color:#24292E;">(user);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 添加文档数据，数据格式为 JSON 格式</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(productJson,XContentType.JSON);</span></span>
<span class="line"><span style="color:#6A737D;">// 客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#24292E;">IndexResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">index</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h5 id="_3-2、修改文档" tabindex="-1">3.2、修改文档 <a class="header-anchor" href="#_3-2、修改文档" aria-label="Permalink to &quot;3.2、修改文档&quot;">​</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 修改文档 - 请求对象</span></span>
<span class="line"><span style="color:#ADBAC7;">UpdateRequest</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">request</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">UpdateRequest</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#768390;">// 配置修改参数</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">index</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;user&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">id</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;1001&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#768390;">// 设置请求体，对数据进行修改</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">doc</span><span style="color:#ADBAC7;">(XContentType.JSON, </span><span style="color:#96D0FF;">&quot;sex&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;女&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#768390;">// 客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#ADBAC7;">UpdateResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">update</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 修改文档 - 请求对象</span></span>
<span class="line"><span style="color:#24292E;">UpdateRequest request </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">UpdateRequest</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#6A737D;">// 配置修改参数</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">index</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;1001&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 设置请求体，对数据进行修改</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">doc</span><span style="color:#24292E;">(XContentType.JSON, </span><span style="color:#032F62;">&quot;sex&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;女&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#24292E;">UpdateResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h5 id="_3-3、查询文档" tabindex="-1">3.3、查询文档 <a class="header-anchor" href="#_3-3、查询文档" aria-label="Permalink to &quot;3.3、查询文档&quot;">​</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 创建请求对象</span></span>
<span class="line"><span style="color:#ADBAC7;">GetRequest</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">request</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">GetRequest</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">index</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;user&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">id</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;1001&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#768390;">// 客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#ADBAC7;">GetResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">get</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 创建请求对象</span></span>
<span class="line"><span style="color:#24292E;">GetRequest request </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">GetRequest</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">index</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;1001&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#24292E;">GetResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h5 id="_3-4、删除文档" tabindex="-1">3.4、删除文档 <a class="header-anchor" href="#_3-4、删除文档" aria-label="Permalink to &quot;3.4、删除文档&quot;">​</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">//创建请求对象</span></span>
<span class="line"><span style="color:#ADBAC7;">DeleteRequest</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">request</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">DeleteRequest</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">index</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;user&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">id</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;1&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#768390;">//客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#ADBAC7;">DeleteResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">delete</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//创建请求对象</span></span>
<span class="line"><span style="color:#24292E;">DeleteRequest request </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeleteRequest</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">index</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;1&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">//客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#24292E;">DeleteResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h5 id="_3-5、批量新增" tabindex="-1">3.5、批量新增 <a class="header-anchor" href="#_3-5、批量新增" aria-label="Permalink to &quot;3.5、批量新增&quot;">​</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">//创建批量新增请求对象</span></span>
<span class="line"><span style="color:#ADBAC7;">BulkRequest</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">request</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">BulkRequest</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">add</span><span style="color:#ADBAC7;">(</span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">IndexRequest</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">index</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;user&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">id</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;1001&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(XContentType.JSON, </span><span style="color:#96D0FF;">&quot;name&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;zhangsan&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">add</span><span style="color:#ADBAC7;">(</span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">IndexRequest</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">index</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;user&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">id</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;1002&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(XContentType.JSON, </span><span style="color:#96D0FF;">&quot;name&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;lisi&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">add</span><span style="color:#ADBAC7;">(</span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">IndexRequest</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">index</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;user&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">id</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;1003&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(XContentType.JSON, </span><span style="color:#96D0FF;">&quot;name&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;wangwu&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"><span style="color:#768390;">//客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#ADBAC7;">BulkResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">responses</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">bulk</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//创建批量新增请求对象</span></span>
<span class="line"><span style="color:#24292E;">BulkRequest request </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">BulkRequest</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">add</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IndexRequest</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">index</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;1001&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(XContentType.JSON, </span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;zhangsan&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">add</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IndexRequest</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">index</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;1002&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(XContentType.JSON, </span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;lisi&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">add</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IndexRequest</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">index</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;1003&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(XContentType.JSON, </span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;wangwu&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#6A737D;">//客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#24292E;">BulkResponse responses </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">bulk</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h5 id="_3-6、批量删除" tabindex="-1">3.6、批量删除 <a class="header-anchor" href="#_3-6、批量删除" aria-label="Permalink to &quot;3.6、批量删除&quot;">​</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">//创建批量删除请求对象</span></span>
<span class="line"><span style="color:#ADBAC7;">BulkRequest</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">request</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">BulkRequest</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">add</span><span style="color:#ADBAC7;">(</span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">DeleteRequest</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">index</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;user&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">id</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;1001&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">add</span><span style="color:#ADBAC7;">(</span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">DeleteRequest</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">index</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;user&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">id</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;1002&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">add</span><span style="color:#ADBAC7;">(</span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">DeleteRequest</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">index</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;user&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">id</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;1003&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"><span style="color:#768390;">//客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#ADBAC7;">BulkResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">responses</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">bulk</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//创建批量删除请求对象</span></span>
<span class="line"><span style="color:#24292E;">BulkRequest request </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">BulkRequest</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">add</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeleteRequest</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">index</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;1001&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">add</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeleteRequest</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">index</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;1002&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">add</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeleteRequest</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">index</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;1003&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#6A737D;">//客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#24292E;">BulkResponse responses </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">bulk</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h4 id="_4、高级查询-1" tabindex="-1">4、高级查询 <a class="header-anchor" href="#_4、高级查询-1" aria-label="Permalink to &quot;4、高级查询&quot;">​</a></h4><h5 id="_4-1、请求体查询" tabindex="-1">4.1、请求体查询 <a class="header-anchor" href="#_4-1、请求体查询" aria-label="Permalink to &quot;4.1、请求体查询&quot;">​</a></h5><h6 id="_4-1-1、查询所有索引数据" tabindex="-1">4.1.1、查询所有索引数据 <a class="header-anchor" href="#_4-1-1、查询所有索引数据" aria-label="Permalink to &quot;4.1.1、查询所有索引数据&quot;">​</a></h6><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 创建搜索请求对象</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchRequest</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">request</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchRequest</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">indices</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;student&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#768390;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchSourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">sourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchSourceBuilder</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#768390;">// 查询所有数据</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">query</span><span style="color:#ADBAC7;">(QueryBuilders.</span><span style="color:#DCBDFB;">matchAllQuery</span><span style="color:#ADBAC7;">());</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">search</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 创建搜索请求对象</span></span>
<span class="line"><span style="color:#24292E;">SearchRequest request </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchRequest</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">indices</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;student&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#24292E;">SearchSourceBuilder sourceBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchSourceBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#6A737D;">// 查询所有数据</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">matchAllQuery</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#24292E;">SearchResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">search</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h6 id="_4-1-2、term-查询-查询条件为关键字" tabindex="-1">4.1.2、term 查询，查询条件为关键字 <a class="header-anchor" href="#_4-1-2、term-查询-查询条件为关键字" aria-label="Permalink to &quot;4.1.2、term 查询，查询条件为关键字&quot;">​</a></h6><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchSourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">sourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchSourceBuilder</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">query</span><span style="color:#ADBAC7;">(QueryBuilders.</span><span style="color:#DCBDFB;">termQuery</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;age&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;30&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">search</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#24292E;">SearchSourceBuilder sourceBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchSourceBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">termQuery</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;age&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;30&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#24292E;">SearchResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">search</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h6 id="_4-1-3、分页查询" tabindex="-1">4.1.3、分页查询 <a class="header-anchor" href="#_4-1-3、分页查询" aria-label="Permalink to &quot;4.1.3、分页查询&quot;">​</a></h6><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchSourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">sourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchSourceBuilder</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">query</span><span style="color:#ADBAC7;">(QueryBuilders.</span><span style="color:#DCBDFB;">matchAllQuery</span><span style="color:#ADBAC7;">());</span></span>
<span class="line"><span style="color:#768390;">// 分页查询</span></span>
<span class="line"><span style="color:#768390;">// 当前页其实索引(第一条数据的顺序号)，from</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">from</span><span style="color:#ADBAC7;">(</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#768390;">// 每页显示多少条 size</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">size</span><span style="color:#ADBAC7;">(</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">search</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#24292E;">SearchSourceBuilder sourceBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchSourceBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">matchAllQuery</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#6A737D;">// 分页查询</span></span>
<span class="line"><span style="color:#6A737D;">// 当前页其实索引(第一条数据的顺序号)，from</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">from</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 每页显示多少条 size</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">size</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#24292E;">SearchResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">search</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h6 id="_4-1-4、数据排序" tabindex="-1">4.1.4、数据排序 <a class="header-anchor" href="#_4-1-4、数据排序" aria-label="Permalink to &quot;4.1.4、数据排序&quot;">​</a></h6><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchSourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">sourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchSourceBuilder</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">query</span><span style="color:#ADBAC7;">(QueryBuilders.</span><span style="color:#DCBDFB;">matchAllQuery</span><span style="color:#ADBAC7;">());</span></span>
<span class="line"><span style="color:#768390;">// 排序</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">sort</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;age&quot;</span><span style="color:#ADBAC7;">, SortOrder.ASC);</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">search</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#24292E;">SearchSourceBuilder sourceBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchSourceBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">matchAllQuery</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#6A737D;">// 排序</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">sort</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;age&quot;</span><span style="color:#24292E;">, SortOrder.ASC);</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#24292E;">SearchResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">search</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h6 id="_4-1-5、过滤字段" tabindex="-1">4.1.5、过滤字段 <a class="header-anchor" href="#_4-1-5、过滤字段" aria-label="Permalink to &quot;4.1.5、过滤字段&quot;">​</a></h6><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchSourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">sourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchSourceBuilder</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">query</span><span style="color:#ADBAC7;">(QueryBuilders.</span><span style="color:#DCBDFB;">matchAllQuery</span><span style="color:#ADBAC7;">());</span></span>
<span class="line"><span style="color:#768390;">//查询字段过滤</span></span>
<span class="line"><span style="color:#F47067;">String</span><span style="color:#F69D50;">[] </span><span style="color:#ADBAC7;">excludes</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> {};</span></span>
<span class="line"><span style="color:#F47067;">String</span><span style="color:#F69D50;">[] </span><span style="color:#ADBAC7;">includes</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> {</span><span style="color:#96D0FF;">&quot;name&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;age&quot;</span><span style="color:#ADBAC7;">};</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">fetchSource</span><span style="color:#ADBAC7;">(includes, excludes);</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">search</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#24292E;">SearchSourceBuilder sourceBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchSourceBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">matchAllQuery</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#6A737D;">//查询字段过滤</span></span>
<span class="line"><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] excludes </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {};</span></span>
<span class="line"><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] includes </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;age&quot;</span><span style="color:#24292E;">};</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">fetchSource</span><span style="color:#24292E;">(includes, excludes);</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#24292E;">SearchResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">search</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h6 id="_4-1-6、bool-查询" tabindex="-1">4.1.6、Bool 查询 <a class="header-anchor" href="#_4-1-6、bool-查询" aria-label="Permalink to &quot;4.1.6、Bool 查询&quot;">​</a></h6><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchSourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">sourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchSourceBuilder</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">BoolQueryBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">boolQueryBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> QueryBuilders.</span><span style="color:#DCBDFB;">boolQuery</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#768390;">// 必须包含</span></span>
<span class="line"><span style="color:#ADBAC7;">boolQueryBuilder.</span><span style="color:#DCBDFB;">must</span><span style="color:#ADBAC7;">(QueryBuilders.</span><span style="color:#DCBDFB;">matchQuery</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;age&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;30&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"><span style="color:#768390;">// 一定不含</span></span>
<span class="line"><span style="color:#ADBAC7;">boolQueryBuilder.</span><span style="color:#DCBDFB;">mustNot</span><span style="color:#ADBAC7;">(QueryBuilders.</span><span style="color:#DCBDFB;">matchQuery</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;name&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;zhangsan&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"><span style="color:#768390;">// 可能包含</span></span>
<span class="line"><span style="color:#ADBAC7;">boolQueryBuilder.</span><span style="color:#DCBDFB;">should</span><span style="color:#ADBAC7;">(QueryBuilders.</span><span style="color:#DCBDFB;">matchQuery</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;sex&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;男&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">query</span><span style="color:#ADBAC7;">(boolQueryBuilder);</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">search</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#24292E;">SearchSourceBuilder sourceBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchSourceBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">BoolQueryBuilder boolQueryBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> QueryBuilders.</span><span style="color:#6F42C1;">boolQuery</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#6A737D;">// 必须包含</span></span>
<span class="line"><span style="color:#24292E;">boolQueryBuilder.</span><span style="color:#6F42C1;">must</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">matchQuery</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;age&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;30&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#6A737D;">// 一定不含</span></span>
<span class="line"><span style="color:#24292E;">boolQueryBuilder.</span><span style="color:#6F42C1;">mustNot</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">matchQuery</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;zhangsan&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#6A737D;">// 可能包含</span></span>
<span class="line"><span style="color:#24292E;">boolQueryBuilder.</span><span style="color:#6F42C1;">should</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">matchQuery</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;sex&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;男&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">(boolQueryBuilder);</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#24292E;">SearchResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">search</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h6 id="_4-1-7、范围查询" tabindex="-1">4.1.7、范围查询 <a class="header-anchor" href="#_4-1-7、范围查询" aria-label="Permalink to &quot;4.1.7、范围查询&quot;">​</a></h6><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchSourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">sourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchSourceBuilder</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">RangeQueryBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">rangeQuery</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> QueryBuilders.</span><span style="color:#DCBDFB;">rangeQuery</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;age&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#768390;">// 大于等于</span></span>
<span class="line"><span style="color:#ADBAC7;">rangeQuery.</span><span style="color:#DCBDFB;">gte</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;30&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#768390;">// 小于等于</span></span>
<span class="line"><span style="color:#ADBAC7;">rangeQuery.</span><span style="color:#DCBDFB;">lte</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;40&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">query</span><span style="color:#ADBAC7;">(rangeQuery);</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">search</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#24292E;">SearchSourceBuilder sourceBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchSourceBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">RangeQueryBuilder rangeQuery </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> QueryBuilders.</span><span style="color:#6F42C1;">rangeQuery</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;age&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 大于等于</span></span>
<span class="line"><span style="color:#24292E;">rangeQuery.</span><span style="color:#6F42C1;">gte</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;30&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 小于等于</span></span>
<span class="line"><span style="color:#24292E;">rangeQuery.</span><span style="color:#6F42C1;">lte</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;40&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">(rangeQuery);</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#24292E;">SearchResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">search</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h6 id="_4-1-8、模糊查询" tabindex="-1">4.1.8、模糊查询 <a class="header-anchor" href="#_4-1-8、模糊查询" aria-label="Permalink to &quot;4.1.8、模糊查询&quot;">​</a></h6><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchSourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">sourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchSourceBuilder</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">query</span><span style="color:#ADBAC7;">(QueryBuilders.</span><span style="color:#DCBDFB;">fuzzyQuery</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;name&quot;</span><span style="color:#ADBAC7;">,</span><span style="color:#96D0FF;">&quot;zhangsan&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">fuzziness</span><span style="color:#ADBAC7;">(Fuzziness.ONE));</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">search</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 构建查询的请求体</span></span>
<span class="line"><span style="color:#24292E;">SearchSourceBuilder sourceBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchSourceBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">(QueryBuilders.</span><span style="color:#6F42C1;">fuzzyQuery</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;zhangsan&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">fuzziness</span><span style="color:#24292E;">(Fuzziness.ONE));</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#24292E;">SearchResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">search</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h5 id="_4-2、高亮查询" tabindex="-1">4.2、高亮查询 <a class="header-anchor" href="#_4-2、高亮查询" aria-label="Permalink to &quot;4.2、高亮查询&quot;">​</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">//创建查询请求体构建器</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchSourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">sourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchSourceBuilder</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#768390;">//构建查询方式：高亮查询</span></span>
<span class="line"><span style="color:#ADBAC7;">TermsQueryBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">termsQueryBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> QueryBuilders.</span><span style="color:#DCBDFB;">termsQuery</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;name&quot;</span><span style="color:#ADBAC7;">,</span><span style="color:#96D0FF;">&quot;zhangsan&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#768390;">//设置查询方式</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">query</span><span style="color:#ADBAC7;">(termsQueryBuilder);</span></span>
<span class="line"><span style="color:#768390;">//构建高亮字段</span></span>
<span class="line"><span style="color:#ADBAC7;">HighlightBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">highlightBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">HighlightBuilder</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">highlightBuilder.</span><span style="color:#DCBDFB;">preTags</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;&lt;font color=&#39;red&#39;&gt;&quot;</span><span style="color:#ADBAC7;">);</span><span style="color:#768390;">//设置标签前缀</span></span>
<span class="line"><span style="color:#ADBAC7;">highlightBuilder.</span><span style="color:#DCBDFB;">postTags</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;&lt;/font&gt;&quot;</span><span style="color:#ADBAC7;">);</span><span style="color:#768390;">//设置标签后缀</span></span>
<span class="line"><span style="color:#ADBAC7;">highlightBuilder.</span><span style="color:#DCBDFB;">field</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;name&quot;</span><span style="color:#ADBAC7;">);</span><span style="color:#768390;">//设置高亮字段</span></span>
<span class="line"><span style="color:#768390;">//设置高亮构建对象</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">highlighter</span><span style="color:#ADBAC7;">(highlightBuilder);</span></span>
<span class="line"><span style="color:#768390;">//设置请求体</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#768390;">//客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">search</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//创建查询请求体构建器</span></span>
<span class="line"><span style="color:#24292E;">SearchSourceBuilder sourceBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchSourceBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#6A737D;">//构建查询方式：高亮查询</span></span>
<span class="line"><span style="color:#24292E;">TermsQueryBuilder termsQueryBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> QueryBuilders.</span><span style="color:#6F42C1;">termsQuery</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;zhangsan&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">//设置查询方式</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">(termsQueryBuilder);</span></span>
<span class="line"><span style="color:#6A737D;">//构建高亮字段</span></span>
<span class="line"><span style="color:#24292E;">HighlightBuilder highlightBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HighlightBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">highlightBuilder.</span><span style="color:#6F42C1;">preTags</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&lt;font color=&#39;red&#39;&gt;&quot;</span><span style="color:#24292E;">);</span><span style="color:#6A737D;">//设置标签前缀</span></span>
<span class="line"><span style="color:#24292E;">highlightBuilder.</span><span style="color:#6F42C1;">postTags</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&lt;/font&gt;&quot;</span><span style="color:#24292E;">);</span><span style="color:#6A737D;">//设置标签后缀</span></span>
<span class="line"><span style="color:#24292E;">highlightBuilder.</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">);</span><span style="color:#6A737D;">//设置高亮字段</span></span>
<span class="line"><span style="color:#6A737D;">//设置高亮构建对象</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">highlighter</span><span style="color:#24292E;">(highlightBuilder);</span></span>
<span class="line"><span style="color:#6A737D;">//设置请求体</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#6A737D;">//客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#24292E;">SearchResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">search</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h5 id="_4-3、聚合查询" tabindex="-1">4.3、聚合查询 <a class="header-anchor" href="#_4-3、聚合查询" aria-label="Permalink to &quot;4.3、聚合查询&quot;">​</a></h5><h6 id="_4-3-1、max" tabindex="-1">4.3.1、max <a class="header-anchor" href="#_4-3-1、max" aria-label="Permalink to &quot;4.3.1、max&quot;">​</a></h6><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#ADBAC7;">SearchRequest</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">request</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchRequest</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">indices</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;student&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchSourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">sourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchSourceBuilder</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">aggregation</span><span style="color:#ADBAC7;">(AggregationBuilders.</span><span style="color:#DCBDFB;">max</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;maxAge&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">field</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;age&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"><span style="color:#768390;">//设置请求体</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#768390;">//3.客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">search</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">SearchRequest request </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchRequest</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">indices</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;student&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">SearchSourceBuilder sourceBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchSourceBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">aggregation</span><span style="color:#24292E;">(AggregationBuilders.</span><span style="color:#6F42C1;">max</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;maxAge&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;age&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#6A737D;">//设置请求体</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#6A737D;">//3.客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#24292E;">SearchResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">search</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h6 id="_4-3-2、分组统计" tabindex="-1">4.3.2、分组统计 <a class="header-anchor" href="#_4-3-2、分组统计" aria-label="Permalink to &quot;4.3.2、分组统计&quot;">​</a></h6><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#ADBAC7;">SearchRequest</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">request</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchRequest</span><span style="color:#ADBAC7;">().</span><span style="color:#DCBDFB;">indices</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;student&quot;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchSourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">sourceBuilder</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">new</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">SearchSourceBuilder</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">sourceBuilder.</span><span style="color:#DCBDFB;">aggregation</span><span style="color:#ADBAC7;">(AggregationBuilders.</span><span style="color:#DCBDFB;">terms</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;age_groupby&quot;</span><span style="color:#ADBAC7;">).</span><span style="color:#DCBDFB;">field</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&quot;age&quot;</span><span style="color:#ADBAC7;">));</span></span>
<span class="line"><span style="color:#768390;">//设置请求体</span></span>
<span class="line"><span style="color:#ADBAC7;">request.</span><span style="color:#DCBDFB;">source</span><span style="color:#ADBAC7;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#768390;">//3.客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#ADBAC7;">SearchResponse</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">response</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> client.</span><span style="color:#DCBDFB;">search</span><span style="color:#ADBAC7;">(request, RequestOptions.DEFAULT);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">SearchRequest request </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchRequest</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">indices</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;student&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">SearchSourceBuilder sourceBuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SearchSourceBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">sourceBuilder.</span><span style="color:#6F42C1;">aggregation</span><span style="color:#24292E;">(AggregationBuilders.</span><span style="color:#6F42C1;">terms</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;age_groupby&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">field</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;age&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#6A737D;">//设置请求体</span></span>
<span class="line"><span style="color:#24292E;">request.</span><span style="color:#6F42C1;">source</span><span style="color:#24292E;">(sourceBuilder);</span></span>
<span class="line"><span style="color:#6A737D;">//3.客户端发送请求，获取响应对象</span></span>
<span class="line"><span style="color:#24292E;">SearchResponse response </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.</span><span style="color:#6F42C1;">search</span><span style="color:#24292E;">(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h3 id="零停机重建索引" tabindex="-1">零停机重建索引 <a class="header-anchor" href="#零停机重建索引" aria-label="Permalink to &quot;零停机重建索引&quot;">​</a></h3><h4 id="背景" tabindex="-1">背景 <a class="header-anchor" href="#背景" aria-label="Permalink to &quot;背景&quot;">​</a></h4><p>  一开始，依靠dynamic mapping，插入数据，但是不小心有些数据是2019-09-10这种日期格式的，所以title这种field被自动映射为了date类型，实际上它应该是string类型的，当后期向索引中加入string类型的title值的时候，就会报错；如果此时想修改title的类型，是不可能的；唯一的办法，就是进行reindex，也就是说，重新建立一个索引，将旧索引的数据查询出来，再导入新索引。</p><h4 id="操作" tabindex="-1">操作 <a class="header-anchor" href="#操作" aria-label="Permalink to &quot;操作&quot;">​</a></h4><ol><li>建立别名，这个别名是指向旧索引的；</li><li>新建一个index，调整映射</li><li>使用scroll api将数据批量查询出来；采用bulk api将scoll查出来的一批数据，批量写入新索引（反复循环执行）</li><li>将第一步新建的别名切换到新的索引上去，直接通过index别名使用新的索引中的数据，java应用程序不需要停机，零提交，高可用</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">// 切换别名</span></span>
<span class="line"><span style="color:#ADBAC7;">POST </span><span style="color:#F47067;">/</span><span style="color:#ADBAC7;">_aliases</span></span>
<span class="line"><span style="color:#ADBAC7;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#96D0FF;">&quot;actions&quot;</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> [</span></span>
<span class="line"><span style="color:#ADBAC7;">        { </span><span style="color:#96D0FF;">&quot;remove&quot;</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> { </span><span style="color:#96D0FF;">&quot;index&quot;</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;my_index&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;alias&quot;</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;prod_index&quot;</span><span style="color:#ADBAC7;"> }},</span></span>
<span class="line"><span style="color:#ADBAC7;">        { </span><span style="color:#96D0FF;">&quot;add&quot;</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;">    { </span><span style="color:#96D0FF;">&quot;index&quot;</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;my_index_new&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&quot;alias&quot;</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;prod_index&quot;</span><span style="color:#ADBAC7;"> }}</span></span>
<span class="line"><span style="color:#ADBAC7;">    ]</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 切换别名</span></span>
<span class="line"><span style="color:#24292E;">POST </span><span style="color:#D73A49;">/</span><span style="color:#24292E;">_aliases</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;actions&quot;</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">        { </span><span style="color:#032F62;">&quot;remove&quot;</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> { </span><span style="color:#032F62;">&quot;index&quot;</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;my_index&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;alias&quot;</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;prod_index&quot;</span><span style="color:#24292E;"> }},</span></span>
<span class="line"><span style="color:#24292E;">        { </span><span style="color:#032F62;">&quot;add&quot;</span><span style="color:#D73A49;">:</span><span style="color:#24292E;">    { </span><span style="color:#032F62;">&quot;index&quot;</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;my_index_new&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;alias&quot;</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;prod_index&quot;</span><span style="color:#24292E;"> }}</span></span>
<span class="line"><span style="color:#24292E;">    ]</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="es7-sql新特性" tabindex="-1">es7 sql新特性 <a class="header-anchor" href="#es7-sql新特性" aria-label="Permalink to &quot;es7 sql新特性&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">POST</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/_sql?format=txt</span></span>
<span class="line"><span style="color:#768390;"># format(显示方法)  csv,json,tsv,txt,ymal,cbor,smile</span></span>
<span class="line"><span style="color:#ADBAC7;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;SELECT * FROM tvs &quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;"># sql 翻译</span></span>
<span class="line"><span style="color:#F69D50;">POST</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/_sql/translate</span></span>
<span class="line"><span style="color:#ADBAC7;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;SELECT * FROM tvs &quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;"># 与其他DSL结合</span></span>
<span class="line"><span style="color:#F69D50;">POST</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">/_sql?format=txt</span></span>
<span class="line"><span style="color:#ADBAC7;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;query&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;SELECT * FROM tvs&quot;,</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">&quot;filter&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">&quot;range&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">&quot;price&quot;</span><span style="color:#6CB6FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;gte&quot;</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1200</span><span style="color:#96D0FF;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">                </span><span style="color:#F69D50;">&quot;lte&quot;</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2000</span></span>
<span class="line"><span style="color:#ADBAC7;">            }</span></span>
<span class="line"><span style="color:#ADBAC7;">        }</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">POST</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/_sql?format=txt</span></span>
<span class="line"><span style="color:#6A737D;"># format(显示方法)  csv,json,tsv,txt,ymal,cbor,smile</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;SELECT * FROM tvs &quot;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># sql 翻译</span></span>
<span class="line"><span style="color:#6F42C1;">POST</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/_sql/translate</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;SELECT * FROM tvs &quot;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 与其他DSL结合</span></span>
<span class="line"><span style="color:#6F42C1;">POST</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/_sql?format=txt</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;query&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;SELECT * FROM tvs&quot;,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;filter&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;range&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;price&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;gte&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1200</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">&quot;lte&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2000</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="kibana" tabindex="-1">Kibana <a class="header-anchor" href="#kibana" aria-label="Permalink to &quot;Kibana&quot;">​</a></h2><p>  Kibana 是一款开源的数据分析和可视化平台，它是 Elastic Stack 成员之一，设计用于和 Elasticsearch 协作。您可以使用 Kibana 对 Elasticsearch 索引中的数据进行搜索、查看、交互操作。您可以很方便的利用图表、表格及地图对数据进行多元化的分析和呈现。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;"># 配置安装</span></span>
<span class="line"><span style="color:#768390;">#解压安装包</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">tar</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-xvf</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">kibana-6.5.4-linux-x86_64.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">#修改配置文件</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">vim</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">config/kibana.yml</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">server.host:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;192.168.40.133&quot;</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;">#对外暴露服务的地址</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">elasticsearch.url:</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;http://192.168.40.133:9200&quot;</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;">#配置Elasticsearch</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">#启动</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">./bin/kibana</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">#通过浏览器进行访问</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">http://192.168.40.133:5601/app/kibana</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 配置安装</span></span>
<span class="line"><span style="color:#6A737D;">#解压安装包</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">tar</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-xvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kibana-6.5.4-linux-x86_64.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#修改配置文件</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">vim</span><span style="color:#24292E;"> </span><span style="color:#032F62;">config/kibana.yml</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">server.host:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;192.168.40.133&quot;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#对外暴露服务的地址</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">elasticsearch.url:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;http://192.168.40.133:9200&quot;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#配置Elasticsearch</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#启动</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">./bin/kibana</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#通过浏览器进行访问</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">http://192.168.40.133:5601/app/kibana</span></span></code></pre></div><h2 id="logstash" tabindex="-1">Logstash <a class="header-anchor" href="#logstash" aria-label="Permalink to &quot;Logstash&quot;">​</a></h2><ul><li>Logstash是开源的服务器端数据处理管道，能够同时从多个来源采集数据，转换数据，然后将数据发送到您最喜欢的“存储库”（es）中。</li><li>logstash是一个数据抽取工具，将数据从一个地方转移到另一个地方。</li><li>logstash之所以功能强大和流行，还与其丰富的过滤器插件是分不开的，过滤器提供的并不单单是过滤的功能，还可以对进入过滤器的原始数据进行复杂的逻辑处理，甚至添加独特的事件到后续流程中。 <img src="/charles-blog/assets/LogStash.0cc2184d.png" alt="LogStash"></li></ul><h3 id="部署安装" tabindex="-1">部署安装 <a class="header-anchor" href="#部署安装" aria-label="Permalink to &quot;部署安装&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;">#检查jdk环境，要求jdk1.8+</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">java</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-version</span></span>
<span class="line"><span style="color:#768390;">#解压安装包</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">tar</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-xvf</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">logstash-6.5.4.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">#第一个logstash示例</span></span>
<span class="line"><span style="color:#F69D50;">bin/logstash</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-e</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;input { stdin { } } output { stdout {} }&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;"># 配置文件启动</span></span>
<span class="line"><span style="color:#F69D50;">logstash.bat</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">-f</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">../config/test1.conf</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#检查jdk环境，要求jdk1.8+</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">java</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-version</span></span>
<span class="line"><span style="color:#6A737D;">#解压安装包</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">tar</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-xvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">logstash-6.5.4.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#第一个logstash示例</span></span>
<span class="line"><span style="color:#6F42C1;">bin/logstash</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-e</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;input { stdin { } } output { stdout {} }&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 配置文件启动</span></span>
<span class="line"><span style="color:#6F42C1;">logstash.bat</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">../config/test1.conf</span></span></code></pre></div><h3 id="配置文件详解" tabindex="-1">配置文件详解 <a class="header-anchor" href="#配置文件详解" aria-label="Permalink to &quot;配置文件详解&quot;">​</a></h3><p>  Logstash配置文件有如下三部分组成，其中input、output部分是必须配置，filter部分是可选配置，而filter就是过滤器插件，可以在这部分实现各种日志过滤功能。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">input</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;">#输入</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">stdin</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">...</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">}</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;">#标准输入</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F69D50;">filter</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;">#过滤，对数据进行分割、截取等处理</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#6CB6FF;">...</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F69D50;">output</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;">#输出</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">stdout</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">...</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">}</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;">#标准输出</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">input</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#输入</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">stdin</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#032F62;">...</span><span style="color:#24292E;"> </span><span style="color:#032F62;">}</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#标准输入</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">filter</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#过滤，对数据进行分割、截取等处理</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">output</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#输出</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">stdout</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#032F62;">...</span><span style="color:#24292E;"> </span><span style="color:#032F62;">}</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#标准输出</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h4 id="输入" tabindex="-1">输入 <a class="header-anchor" href="#输入" aria-label="Permalink to &quot;输入&quot;">​</a></h4><ul><li>采集各种样式、大小和来源的数据，数据往往以各种各样的形式，或分散或集中地存在于很多系统中。</li><li>Logstash 支持各种输入选择 ，可以在同一时间从众多常用来源捕捉事件。能够以连续的流式传输方式，轻松地从您的日志、指标、Web 应用、数据存储以及各种 AWS 服务采集数据。</li></ul><h4 id="过滤" tabindex="-1">过滤 <a class="header-anchor" href="#过滤" aria-label="Permalink to &quot;过滤&quot;">​</a></h4><ul><li>实时解析和转换数据</li><li>数据从源传输到存储库的过程中，Logstash 过滤器能够解析各个事件，识别已命名的字段以构建结构，并将它们转换成通用格式，以便更轻松、更快速地分析和实现商业价值。</li></ul><h4 id="输出" tabindex="-1">输出 <a class="header-anchor" href="#输出" aria-label="Permalink to &quot;输出&quot;">​</a></h4><ul><li>Logstash 提供众多输出选择，您可以将数据发送到您要指定的地方，并且能够灵活地解锁众多下游用例。</li></ul><h4 id="示例" tabindex="-1">示例 <a class="header-anchor" href="#示例" aria-label="Permalink to &quot;示例&quot;">​</a></h4><h5 id="读取文件-file" tabindex="-1">读取文件(File) <a class="header-anchor" href="#读取文件-file" aria-label="Permalink to &quot;读取文件(File)&quot;">​</a></h5><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;"># 默认情况下，logstash会从文件的结束位置开始读取数据，也就是说logstash进程会以类似tail -f命令的形式逐行获取数据。</span></span>
<span class="line"><span style="color:#F69D50;">input</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">file</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">path</span><span style="color:#ADBAC7;"> =</span><span style="color:#F47067;">&gt;</span><span style="color:#ADBAC7;"> [</span><span style="color:#96D0FF;">&quot;/var/*/*&quot;</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">start_position</span><span style="color:#ADBAC7;"> =</span><span style="color:#F47067;">&gt;</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;beginning&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span>
<span class="line"><span style="color:#F69D50;">output</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">stdout</span><span style="color:#ADBAC7;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">        codec</span><span style="color:#F47067;">=&gt;</span><span style="color:#96D0FF;">rubydebug</span><span style="color:#ADBAC7;">    </span><span style="color:#768390;"># 标准输出</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 默认情况下，logstash会从文件的结束位置开始读取数据，也就是说logstash进程会以类似tail -f命令的形式逐行获取数据。</span></span>
<span class="line"><span style="color:#6F42C1;">input</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">file</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">path</span><span style="color:#24292E;"> =</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> [</span><span style="color:#032F62;">&quot;/var/*/*&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">start_position</span><span style="color:#24292E;"> =</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;beginning&quot;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#6F42C1;">output</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">stdout</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">        codec</span><span style="color:#D73A49;">=&gt;</span><span style="color:#032F62;">rubydebug</span><span style="color:#24292E;">    </span><span style="color:#6A737D;"># 标准输出</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="读取tcp网络数据" tabindex="-1">读取TCP网络数据 <a class="header-anchor" href="#读取tcp网络数据" aria-label="Permalink to &quot;读取TCP网络数据&quot;">​</a></h5><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F69D50;">input</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">tcp</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">port</span><span style="color:#ADBAC7;"> =</span><span style="color:#F47067;">&gt;</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;1234&quot;</span></span>
<span class="line"><span style="color:#ADBAC7;">  }</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F69D50;">filter</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">grok</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">match</span><span style="color:#ADBAC7;"> =</span><span style="color:#F47067;">&gt;</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;message&quot;</span><span style="color:#ADBAC7;"> =</span><span style="color:#F47067;">&gt;</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;%{SYSLOGLINE}&quot;</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">}</span></span>
<span class="line"><span style="color:#ADBAC7;">  }</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F69D50;">output</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">file</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">path</span><span style="color:#ADBAC7;"> =</span><span style="color:#F47067;">&gt;</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;/data/log/%{+yyyy-MM-dd}/%{host}_%{+HH}.log&quot;</span><span style="color:#ADBAC7;">  </span><span style="color:#768390;"># 输出到文件</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F69D50;">output</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F69D50;">elasticsearch</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">{</span><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 输出到es</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">host</span><span style="color:#ADBAC7;"> =</span><span style="color:#F47067;">&gt;</span><span style="color:#ADBAC7;"> [</span><span style="color:#96D0FF;">&quot;192.168.1.1:9200&quot;</span><span style="color:#ADBAC7;">,</span><span style="color:#96D0FF;">&quot;172.16.213.77:9200&quot;</span><span style="color:#ADBAC7;">]  </span><span style="color:#768390;"># 是一个数组类型的值，后面跟的值是elasticsearch节点的地址与端口，默认端口是9200。可添加多个地址。</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">index</span><span style="color:#ADBAC7;"> =</span><span style="color:#F47067;">&gt;</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;logstash-%{+YYYY.MM.dd}&quot;</span><span style="color:#ADBAC7;">   </span><span style="color:#768390;"># 写入elasticsearch的索引的名称，这里可以使用变量。</span></span>
<span class="line"><span style="color:#ADBAC7;">    }</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">input</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">tcp</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">port</span><span style="color:#24292E;"> =</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;1234&quot;</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">filter</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">grok</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">match</span><span style="color:#24292E;"> =</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;message&quot;</span><span style="color:#24292E;"> =</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;%{SYSLOGLINE}&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">}</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">output</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">file</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">path</span><span style="color:#24292E;"> =</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;/data/log/%{+yyyy-MM-dd}/%{host}_%{+HH}.log&quot;</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># 输出到文件</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">output</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">elasticsearch</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 输出到es</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">host</span><span style="color:#24292E;"> =</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> [</span><span style="color:#032F62;">&quot;192.168.1.1:9200&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;172.16.213.77:9200&quot;</span><span style="color:#24292E;">]  </span><span style="color:#6A737D;"># 是一个数组类型的值，后面跟的值是elasticsearch节点的地址与端口，默认端口是9200。可添加多个地址。</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">index</span><span style="color:#24292E;"> =</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;logstash-%{+YYYY.MM.dd}&quot;</span><span style="color:#24292E;">   </span><span style="color:#6A737D;"># 写入elasticsearch的索引的名称，这里可以使用变量。</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-462c643b data-v-f6bde3e6><!--[--><!--]--><div class="edit-info" data-v-f6bde3e6><!----><div class="last-updated" data-v-f6bde3e6><p class="VPLastUpdated" data-v-f6bde3e6 data-v-cfcf869c>最后更新: <time datetime="2023-08-12T07:30:38.000Z" data-v-cfcf869c></time></p></div></div><div class="prev-next" data-v-f6bde3e6><div class="pager" data-v-f6bde3e6><a class="pager-link prev" href="/charles-blog/md/database/Redis.html" data-v-f6bde3e6><span class="desc" data-v-f6bde3e6>上一篇</span><span class="title" data-v-f6bde3e6>Redis</span></a></div><div class="has-prev pager" data-v-f6bde3e6><a class="pager-link next" href="/charles-blog/md/database/MongoDB.html" data-v-f6bde3e6><span class="desc" data-v-f6bde3e6>下一篇</span><span class="title" data-v-f6bde3e6>MongoDB</span></a></div></div></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"md_test_child1.md\":\"6f9aed24\",\"md_test_index.md\":\"a179ba4f\",\"md_test_lin_index.md\":\"706ea71f\",\"index.md\":\"4503a516\",\"md_test_zhu_index.md\":\"2c99a562\",\"md_network_dns.md\":\"7a6bd009\",\"md_network_conversationtechnolog.md\":\"f21c82a7\",\"md_network_http.md\":\"fa7644b0\",\"md_network_ip.md\":\"b8f18932\",\"md_network_loadbalance.md\":\"1714c06e\",\"md_network_mac.md\":\"992dbcbd\",\"md_network_https.md\":\"1fbe42dd\",\"md_network_model.md\":\"7a0f94c4\",\"md_network_networkdevices.md\":\"7a850f72\",\"md_network_index.md\":\"09603bc1\",\"md_network_tcp.md\":\"fcf7ac1f\",\"md_middleware_index.md\":\"1c4b5f2c\",\"md_about_index.md\":\"4984c4d8\",\"md_middleware_activemq.md\":\"45ec1a9b\",\"md_environment_index.md\":\"4e1f2168\",\"md_database_cache.md\":\"ee1e9375\",\"md_middleware_jms.md\":\"ac6f5658\",\"md_database_mongodb.md\":\"ed78548e\",\"md_distributed_index.md\":\"85eafa6b\",\"md_environment_linux.md\":\"9e61f6d8\",\"md_environment_shell.md\":\"779c4602\",\"md_java_javaunderlayer_classloader.md\":\"a28e97d8\",\"md_java_index.md\":\"8e3f7d5f\",\"md_middleware_kafka.md\":\"3238de67\",\"md_distributed_singlesignon.md\":\"e9469380\",\"md_environment_docker.md\":\"6d9d0c36\",\"md_database_redis.md\":\"2eb607ad\",\"md_java_javaother_java8.md\":\"98624343\",\"md_java_javaother_thread.md\":\"2ad6e1e2\",\"md_java_javaunderlayer_gc.md\":\"8b102f85\",\"md_java_javaunderlayer_hash.md\":\"e1bfbdd6\",\"md_java_javaunderlayer_jvm.md\":\"4a6ccd9b\",\"md_java_javaunderlayer_memoryleak.md\":\"0d57ac68\",\"md_java_javaother_javainterviewquestions.md\":\"b05c4f2a\",\"md_java_javaother_lock.md\":\"1b11e871\",\"md_java_javaweb_javaweb.md\":\"cc6cf75c\",\"md_java_javaother_synchronized.md\":\"ee25ab08\",\"md_java_javaother_regularexpression.md\":\"dbb63f3f\",\"md_java_mybatis_mybatis.md\":\"d9803a83\",\"md_java_spring_springmvc.md\":\"d3ce0b21\",\"md_java_spring_springannotations.md\":\"89640029\",\"md_java_spring_springboot.md\":\"5bba519d\",\"md_java_spring_spring.md\":\"a80a4f49\",\"md_java_mybatis_mybatisplus.md\":\"a46e638f\",\"md_middleware_nginx.md\":\"2bf5bd09\",\"md_java_spring_springtransaction.md\":\"ef9c6d8a\",\"md_database_index.md\":\"8ef353e5\",\"md_middleware_arthas.md\":\"ed6d7630\",\"md_database_oracle.md\":\"7147de3e\",\"md_middleware_rabbitmq.md\":\"17ee6046\",\"md_middleware_zookeeper.md\":\"7a7e70a5\",\"md_java_javaother_designpatterns.md\":\"0858d58e\",\"md_database_elkstack.md\":\"ca5582c6\",\"md_database_mysql.md\":\"c1f317d9\"}")
__VP_SITE_DATA__ = JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"小朱杂记\",\"description\":\"My Document\",\"base\":\"/charles-blog/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Java\",\"link\":\"/md/java/\",\"activeMatch\":\"/md/java/\"},{\"text\":\"数据库\",\"link\":\"/md/database/\",\"activeMatch\":\"/md/database/\"},{\"text\":\"中间件\",\"link\":\"/md/middleware/\",\"activeMatch\":\"/md/middleware/\"},{\"text\":\"网络\",\"link\":\"/md/network/\",\"activeMatch\":\"/md/network/\"},{\"text\":\"环境\",\"link\":\"/md/environment/\",\"activeMatch\":\"/md/environment/\"},{\"text\":\"分布式\",\"link\":\"/md/distributed/\",\"activeMatch\":\"/md/distributed/\"},{\"text\":\"关于我\",\"link\":\"/md/about/\"}],\"sidebar\":{\"/md/java/\":[{\"text\":\"Java\",\"link\":\"/md/java/\",\"items\":[{\"text\":\"Spring \",\"collapsed\":true,\"items\":[{\"text\":\"Spring杂叙\",\"link\":\"/md/java/spring/Spring\"},{\"text\":\"SpringMvc\",\"link\":\"/md/java/spring/SpringMVC\"},{\"text\":\"SpringBoot\",\"link\":\"/md/java/spring/SpringBoot\"},{\"text\":\"Spring事务\",\"link\":\"/md/java/spring/SpringTransaction\"},{\"text\":\"Spring注解\",\"link\":\"/md/java/spring/SpringAnnotations\"}]},{\"text\":\"Java底层\",\"collapsed\":true,\"items\":[{\"text\":\"JVM\",\"link\":\"/md/java/javaUnderlayer/JVM\"},{\"text\":\"GC\",\"link\":\"/md/java/javaUnderlayer/GC\"},{\"text\":\"内存泄漏\",\"link\":\"/md/java/javaUnderlayer/MemoryLeak\"},{\"text\":\"哈希(Hash)\",\"link\":\"/md/java/javaUnderlayer/Hash\"},{\"text\":\"类加载器\",\"link\":\"/md/java/javaUnderlayer/ClassLoader\"}]},{\"text\":\"JavaWeb\",\"collapsed\":true,\"items\":[{\"text\":\"JavaWeb杂叙\",\"link\":\"/md/java/javaWeb/JavaWeb\"}]},{\"text\":\"Java其他\",\"collapsed\":true,\"items\":[{\"text\":\"Java8\",\"link\":\"/md/java/javaOther/Java8\"},{\"text\":\"锁\",\"link\":\"/md/java/javaOther/Lock\"},{\"text\":\"Synchronized\",\"link\":\"/md/java/javaOther/Synchronized\"},{\"text\":\"浅谈设计模式\",\"link\":\"/md/java/javaOther/DesignPatterns\"},{\"text\":\"进程，线程，线程池，调度\",\"link\":\"/md/java/javaOther/Thread\"},{\"text\":\"正则表达式\",\"link\":\"/md/java/javaOther/RegularExpression\"},{\"text\":\"Java面试题\",\"link\":\"/md/java/javaOther/JavaInterviewQuestions\"}]},{\"text\":\"Mybatis\",\"collapsed\":true,\"items\":[{\"text\":\"Mybatis杂叙\",\"link\":\"/md/java/mybatis/Mybatis\"},{\"text\":\"Mybatis-Plus\",\"link\":\"/md/java/mybatis/MybatisPlus\"}]}]}],\"/md/database/\":[{\"text\":\"数据库\",\"link\":\"/md/database/\",\"items\":[{\"text\":\"MySQL\",\"link\":\"/md/database/Mysql\"},{\"text\":\"Oracle\",\"link\":\"/md/database/Oracle\"},{\"text\":\"Redis\",\"link\":\"/md/database/Redis\"},{\"text\":\"ELK Stack\",\"link\":\"/md/database/ElkStack\"},{\"text\":\"MongoDB\",\"link\":\"/md/database/MongoDB\"},{\"text\":\"缓存\",\"link\":\"/md/database/Cache\"}]}],\"/md/network/\":[{\"text\":\"网络\",\"link\":\"/md/network/\",\"items\":[{\"text\":\"网络模型\",\"link\":\"/md/network/Model\"},{\"text\":\"HTTP\",\"link\":\"/md/network/Http\"},{\"text\":\"HTTPS\",\"link\":\"/md/network/Https\"},{\"text\":\"TCP\",\"link\":\"/md/network/Tcp\"},{\"text\":\"IP\",\"link\":\"/md/network/Ip\"},{\"text\":\"MAC\",\"link\":\"/md/network/Mac\"},{\"text\":\"DNS\",\"link\":\"/md/network/Dns\"},{\"text\":\"会话技术\",\"link\":\"/md/network/ConversationTechnolog\"},{\"text\":\"常见的网络设备\",\"link\":\"/md/network/NetworkDevices\"},{\"text\":\"负载均衡\",\"link\":\"/md/network/LoadBalance\"}]}],\"/md/environment/\":[{\"text\":\"环境\",\"link\":\"/md/environment/\",\"items\":[{\"text\":\"Linux\",\"link\":\"/md/environment/Linux\"},{\"text\":\"Shell\",\"link\":\"/md/environment/Shell\"},{\"text\":\"Docker\",\"link\":\"/md/environment/Docker\"}]}],\"/md/distributed/\":[{\"text\":\"分布式\",\"items\":[{\"text\":\"单点登陆\",\"link\":\"/md/distributed/SingleSignOn\"},{\"text\":\"分布式系统\",\"link\":\"/md/distributed/\"}]}],\"/md/middleware/\":[{\"text\":\"中间件\",\"link\":\"/md/middleware/\",\"items\":[{\"text\":\"Nginx\",\"link\":\"/md/middleware/Nginx\"},{\"text\":\"RabbitMQ\",\"link\":\"/md/middleware/Rabbitmq\"},{\"text\":\"Zookeeper\",\"link\":\"/md/middleware/Zookeeper\"},{\"text\":\"Arthas\",\"link\":\"/md/middleware/Arthas\"},{\"text\":\"JMS\",\"link\":\"/md/middleware/Jms\"},{\"text\":\"ActiveMQ\",\"link\":\"/md/middleware/ActiveMq\"},{\"text\":\"Kafka\",\"link\":\"/md/middleware/Kafka\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/CharleZhuJJ/charles-blog\"}],\"outline\":{\"level\":\"deep\",\"label\":\"目录\"},\"darkModeSwitchLabel\":\"切换日光/暗黑模式\",\"sidebarMenuLabel\":\"文章\",\"returnToTopLabel\":\"返回顶部\",\"lastUpdatedText\":\"最后更新\",\"docFooter\":{\"prev\":\"上一篇\",\"next\":\"下一篇\"},\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}")</script>
    
  </body>
</html>