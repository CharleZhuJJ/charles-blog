# Shell

Shell 是一个命令行解释器，它为用户提供了一个向 Linux 内核发送请求以便运行程序的界面系统级程序，用户可以用 Shell 来启动、挂起、停止甚至是编写一些程序.

## Shell脚本格式要求
- 1）脚本以#!/bin/bash 开头。
- 2）脚本需要有可执行权限。

## 脚本的常用执行方式
- 方式1：输入脚本的绝对路径或相对路径
    - 1) 首先要赋予脚本可执行的权限
    - 2) 执行脚本
- 方式 2：sh+脚本。不用赋予脚本+x 权限，直接执行即可（不推荐）

## Shell的变量
Linux Shell 中的变量分为，系统变量和用户自定义变量。
```shell
# 系统变量：
$HOME、$PWD、$SHELL、$USER

# shell 变量的定义:
    [变量名]=[值]
# 撤销变量：
    unset [变量名]
# 声明静态变量.这种方式声明后,不能 unset
    readonly [变量名]
# 定义变量的规则
    1) 变量名称可以由字母、数字和下划线组成，但是不能以数字开头。
    2) 等号两侧不能有空格
    3) 变量名称一般习惯为大写
    
# 将命令的返回值赋给变量
    1）A=`ll` 反引号，运行里面的命令，并把结果返回给变量 A
    2）A=$(ll) 等价于反引号
```    

### 设置环境变量
```shell
# 将 shell 变量输出为环境变量
    export [变量名]=[变量值] 
# 让修改后的配置信息立即生效
    source [配置文件]
# 查询环境变量的值
    echo $变量名
```

### 位置参数变量
```shell
$n # n 为数字，$0 代表命令本身，$1-$9 代表第一到第九个参数，十以上的参数需要用大括号包含，如${10}
$* # 这个变量代表命令行中所有的参数，$*把所有的参数看成一个整体
$@ # 这个变量也代表命令行中所有的参数，不过$@把每个参数区分对待，可以进行遍历操作
$# # 这个变量代表命令行中所有参数的个数
```

### 预定义变量
 shell 设计者事先已经定义好的变量，可以直接在 shell 脚本中使用
```shell
$$ #当前进程的进程号（PID）
$! #后台运行的最后一个进程的进程号（PID）
$? #最后一次执行的命令的返回状态。如果这个变量的值为 0，证明上一个命令正确执行；如果这个变量的值为非 0，则证明上一个命令执行不正确了。
```

### 运算符
```shell
1、 $((运算式))
2、 $[运算式]
3、 expr [运算式] (注意 expr 运算符间要有空格)     +(加)  -(减)   \*(乘)  /(除)  %(取余)

# 示例：计算（2+3）X4 的值
    1） $((（2+3）* 4 ))
    2） $[（2+3）* 4 ]
    3） TEMP=`expr 2 + 3`
        RESULT = `expr $TEMP \* 4`
```

### 条件判断
```shell
# 非空返回 true；condition 前后要有空格
[ condition ]

# 常用判断条件
    1) 两个整数的比较:
        = 字符串比较
        -lt 小于
        -le 小于等于
        -eq 等于
        -gt 大于
        -ge 大于等于
        -ne 不等于
    2) 按照文件权限进行判断
        -r 有读的权限 [ -r 文件名 ]
        -w 有写的权限
        -x 有执行的权限
    3) 按照文件类型进行判断
        -f 文件存在并且是一个常规的文件  [ -f 文件名 ]
        -e 文件存在
        -d 文件存在并是一个目录
```        

### 流程控制
``` shell
# if判断，基本语法
# 方式一：
    if [ 条件判断式 ];then
        程序
    fi
# 方式二：
    if [ 条件判断式 ]  then
        程序
    elif [条件判断式]  then
        程序
    fi

# case语句，基本语法
case $变量名 in
"值 1")
    如果变量的值等于值 1，则执行程序 1
    ;;
"值 2")
    如果变量的值等于值 2，则执行程序 2
    ;;
*)
    如果变量的值都不是以上的值，则执行此程序
    ;;
esac

# for循环，基本语法
# 方式一：
    for 变量 in 值 1 值 2 值 3…
    do
        程序
    done
# 方式二：
for (( 初始值;循环控制条件;变量变化 ))
do
    程序
done

# while循环，基本语法
while [ 条件判断式 ]
do
   程序
done
```

### 读取控制台输入
```shell
read (选项) (参数)
# 常用选项：
    -p：指定读取值时的提示符；
    -t：指定读取值时等待的时间（秒），如果没有在指定的时间内输入，就不再等待了。
# 参数
    变量：指定读取值的变量名
```

### 函数
函数包括：系统函数和自定义函数
```shell
# 系统函数
# basename，返回完整路径最后 / 的部分，常用于获取文件名
basename [pathname] [suffix]
# suffix 为后缀，如果 suffix 被指定了，basename 会将 pathname 或 string 中的 suffix 去掉。

# dirname，返回完整路径最后 / 的前面的部分，常用于返回路径部分
dirname [文件绝对路径]


# 自定义函数
# 定义函数：
    [ function ] funname[()]
    {
        Action;
        [return int;]
    }
# 调用函数，直接写函数名
    funname [值]    
```
