# Linux

## Linux目录结构

/bin  (/usr/bin 、 /usr/local/bin)： 是Binary的缩写, 这个目录存放着最经常使用的命令

/sbin (/usr/sbin 、 /usr/local/sbin)： 就是Super User的意思，这里存放的是系统管理员使用的系统管理程序。

/home： 存放普通用户的主目录，在Linux中每个用户都有一个自己的目录，一般该目录名是以用户的账号命名的。

/root： 该目录为系统管理员，也称作超级权限者的用户主目录。
    
/lib： 系统开机所需要最基本的动态连接共享库，其作用类似于Windows里的DLL文件。几乎所有的应用程序都需要用到这些共享库。

/etc： 所有的系统管理所需要的配置文件和子目录 my.conf
/usr：这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似与windows下的program files目录。

/boot： 存放的是启动Linux时使用的一些核心文件，包括一些连接文件以及镜像文件

/proc：  这个目录是一个虚拟的目录，它是系统内存的映射，访问这个目录来获取系统信息

/srv：  service缩写，该目录存放一些服务启动之后需要提取的数据。

/sys：  该目录下安装了2.6内核中新出现的一个文件系统 

/tmp：  这个目录是用来存放一些临时文件的。

/dev：  类似于windows的设备管理器，把所有的硬件用文件的形式存储。

/media：  linux系统会自动识别一些设备，例如U盘、光驱等等，当识别后，linux会把识别的设备挂载到这个目录下。

/mnt ：  系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将外部的存储挂载在/mnt/上，然后进入该目录就可以查看里的内容了。 d:/myshare

/opt：  这是给主机额外安装软件所摆放的目录。如安装ORACLE数据库就可放到该目录下。默认为空。

/usr/local ：  这是另一个给主机额外安装软件所安装的目录。一般是通过编译源码方式安装的程序

/var：  这个目录中存放着在不断扩充着的东西，习惯将经常被修改的目录放在这个目录下。包括各种日志文件。

![DirectoryStructure](/public/environment/linux/DirectoryStructure.png)

## 相关命令 
### 系统级命令
```shell
# 关机&重启命令：
shutdown：
    shutdown -h now #(表示立即关机)
    shutdown -h 1  #(表示 1 分钟后关机)
    shutdown –h 20:25 #(系统会在今天20:25关机)
    shutdown -r now #(立即重启)

halt
# 就是直接使用，效果等价于关机，等同于shutdown –h now 和 poweroff
reboot
# 就是重启系统。等同于 shutdown –r now
sync
# 把内存的数据同步到磁盘
# ！！！不管是重启系统还是关闭系统，首先要运行sync命令，把内存中的数据写到磁盘中！！！

# 用户登录和注销
# 1、登录时尽量少用 root 帐号登录，因为它是系统管理员，最大的权限，避免操作失误。
# 2、利用普通用户登录，登录后再用"su - 用户名"命令来切换成系统管理员身份.
# 3、在提示符下输入 logout 即可注销用户
```

### 用户，组管理
```shell
# 添加用户
useradd [选项] [用户名]
# 1.当创建用户成功后，会自动的创建和用户同名的家目录
    useradd xm
# 2.也可以通过 useradd -d [指定目录] [新的用户名]，给新创建的用户指定家目录
    useradd -d /home/dog xm
    
# 给用户指定或者修改密码
passwd [用户名]

# 删除用户
userdel [用户名]
# 1.删除用户 xm，但是要保留家目录
    userdel xm
# 2.删除用户 xh 以及用户主目录
    userdel -r xm

# 查询用户信息
id [用户名]

# 切换用户: 如果当前用户的权限不够，可以通过 su - 指令，切换到高权限用户，比如 root
su – [切换用户名]
# 1. 从权限高的用户切换到权限低的用户，不需要输入密码，反之需要。
# 2. 当需要返回到原来用户时，使用 exit 指令

# 查看当前用户/登录用户
whoami 
who am I

# 查询用户信息
id [用户名]

----------------------------------------
# 用户组：类似于角色，系统可以对有共性的多个用户进行统一的管理
# 增加组
groupadd [组名]

# 删除组
groupdel [组名]

----------------------------------------
# 增加用户时直接加上组
useradd -g [用户组] [用户名]

# 修改用户的组
usermod -g [用户组] [用户名]
usermod –d [目录名] [用户名] 改变该用户登陆的初始目录

# 修改文件所有者
chown [用户名] [文件名]
# 修改用户的所有者和所有组
chown [用户名:组名] [文件名]

# 修改文件所在的组
chgrp [组名] [文件名]

# 修改文件或者目录的权限
# 第一种方式：+ 、-、= 变更权限
    u:所有者  g:所有组  o:其他人  a:所有人(u、g、o 的总和)
    # 示例：
        1. chmod u=rwx,g=rx,o=x [文件目录名]
        2. chmod o+w [文件目录名]
        3. chmod a-x [文件目录名]
#  第二种方式：通过数字变更权限
    r=4  w=2  x=1  rwx=4+2+1=7
    # 示例：
        chmod 751  [文件目录名]
```

### 文件和目录操作命令
```shell
# 示当前工作目录的绝对路径：pwd，全拼print working directory
pwd 

# 列出目录的内容及其内容属性信息：ls，全拼list
ls [选项] [目录或是文件]
# 常用选项
    -a：显示当前目录所有的文件和目录，包括隐藏的。
    -l：以列表的方式显示信息
    
# 切换到指定目录：cd，全拼change directory
cd [参数] 
# 1.回到自己的家目录
    cd ~ 或者 cd ：
# 2. 回到当前目录的上一级目录
    cd .. 
    
# 用于创建目录(make directory)
mkdir [选项] [要创建的目录]
# 常用选项：
    -p ：创建多级目录

# 删除空目录：rmdir，全拼remove empty directories
rmdir [选项] [要删除的空目录]
# tips：
    # rmdir 删除的是空目录，如果目录下有内容时无法删除的。
    # 如果需要删除非空目录，需要使用 rm -rf 要删除的目录
    
# 创建空文件
touch [文件名称]

# 拷贝文件到指定目录：cp，全拼copy
cp [选项] [source] [dest]
# 常用选项
    -r ：递归复制整个文件夹
# 使用细节:
    强制覆盖不提示的方法：\cp
    
# 指令移除【删除】文件或目录：rm，全拼remove
rm [选项] [要删除的文件或目录]
# 常用选项
    -r ：递归删除整个文件夹
    -f ：强制删除不提示
    -i ：互动，删除询问是否删除

# 移动文件与目录或重命名
mv [oldNameFile] [newNameFile] (功能描述：重命名)
mv [/movefile] [/targetFolder] (功能描述：移动文件)

# 重命名文件
rename [oldNameFile] [newNameFile] 

# 查看文件内容，是以只读的方式打开。
cat [选项] [要查看的文件]
# 常用选项
    -n ：显示行号
# tips:
    cat 只能浏览文件，而不能修改文件，为了浏览方便，一般会带上管道命令 | more
    cat 文件名 | more [分页浏览]
    
# 文本过滤器more
more [要查看的文件]
# more指令中内置了若干快捷键:
    空白键 ：向下翻一页
    Enter ：向下翻一行
    q ：退出more模式，不再显示该文件内容
    Ctrl + F ：向下滚动一屏
    Ctrl + B ：返回上一屏
    = ： 输出当前行的行号
    :f : 输出文件名和当前行的行号

# 分屏查看文件内容：与 more 指令类似，但是比 more 指令更加强大
less [要查看的文件]

# > 和 >> 
> 指令：输出重定向 : 会将原来的文件的内容覆盖
>> 指令：不会覆盖原来文件的内容，而是追加到文件的尾部。
# 例子：
    ls -l > a.txt  (将 ls -l 的显示的内容覆盖写入到 a.txt 文件，如果该文件不存在，就创建该文件)
    ls -al >> a.txt（列表的内容追加到文件 aa.txt 的末尾）

# 输出内容到控制台
echo [选项] [输出内容]

# 显示文件的开头部分内容，默认显示前10行数据
head [文件] (查看文件头 10 行内容)
head -n 5 [文件] (查看文件头 5 行内容，5 可以是任意行数)

# 输出文件中尾部的内容，默认情况下 tail 指令显示文件的后 10 行内容
tail [文件]（查看文件后 10 行内容）
tail -n 5 [文件]（查看文件后 5 行内容，5 可以是任意行数）
tail -f [文件]（实时追踪该文档的所有更新，工作经常使用）

# 软链接也叫符号链接，类似于 windows 里的快捷方式，主要存放了链接其他文件的路径
ln -s [原文件或目录] [软链接名] （给原文件创建一个软链接）

# 查看已经执行过历史命令,也可以执行历史指令
history （查看已经执行过历史命令）
history 10 (显示最近使用过的 10 个指令)
!5 (执行历史编号为 5 的指令)

# 功能是以树形结构显示目录下的内容
tree

--------------------------------------------------------
# cat的反向拼写，因此命令的功能为反向显示文件内容。
tac

# 将文件的每一行按指定分隔符分割并输出。
cut

# 分割文件为不同的小片段。
split

# 按行合并文件内容。
paste

# 对文件的文本内容排序。
sort

# 去除重复行。
uniq

# 统计文件的行数、单词数或字节数。
wc

# 转换文件的编码格式。
iconv

# 将DOS格式文件转换成UNIX格式。
dos2unix

# 全拼difference，比较文件的差异，常用于文本文件。
diff

# 命令行可视化文件比较工具，常用于文本文件。
vimdiff

# 反向输出文件内容。
rev

# 过滤字符串
grep/egrep

# 按两个文件的相同字段合并。
join

# 替换或删除字符。
tr
```

### 时间日期类
```shell
# 显示当前日期
date （显示当前时间）
date +%Y （显示当前年份）
date +%m （显示当前月份）
date +%d （显示当前是哪一天）
date "+%Y-%m-%d %H:%M:%S" （显示年月日时分秒）

# 设置日期
date -s [字符串时间]

# 查看日历
cal [选项] （不加选项，显示本月日历）
cal 2020 (显示 2020 年日历)
```

### 搜索查找
```shell
# 从指定目录向下递归地遍历其各个子目录，将满足条件的文件或者目录显示在终端
find [搜索范围] [选项]
# 常用选项：
    -name <文件名>： 按照制定的文件名查找
    -user <用户没>： 查找属于指定用户名的所有文件
    -size <文件大小>：按照指定的文件大小查找文件
    
# 快速定位文件路径
locate [文件名]
locate 指令利用事先建立的系统中所有文件名称及路径的locate 数据库实现快速定位给定的文件。
locate 指令无需遍历整个文件系统，查询速度较快。为了保证查询结果的准确度，管理员必须定期更新 locate 时刻。
# 由于 locate 指令基于数据库进行查询，所以第一次运行前，必须使用 updatedb 指令创建 locate 数据库。

# 过滤查找
grep [选项] [查找内容] [源文件]
# 常用选项：
    -n：显示匹配行及行号
    -i：忽略字母大小写
    
# 查找二进制命令，按环境变量PATH路径查找
which
# 查找二进制命令，按环境变量PATH路径查找
whereis
```

### 压缩和解压类
```shell
# 压缩文件
gzip [文件] （压缩文件，只能将文件压缩为*.gz 文件）

zip [选项] [XXX.zip] [将要压缩的内容]（压缩文件和目录的命令）
# 常用选项:
    -r：递归压缩，即压缩目录

# 解压文件
gunzip [文件.gz] （解压缩文件命令）

unzip [选项] [XXX.zip] （解压缩文件)
# 常用选项:
    -d <目录> ：指定解压后文件的存放目录
    
# 打包:
tar [选项] [XXX.tar.gz] [打包的内容]  (打包目录，压缩后的文件格式.tar.gz)
# 常用选项
    -c: 创建.tar打包文件
    -x：解包.tar文件
    （-c 和 -x 指令互斥）
    -v：显示详细信息
    -f：指定压缩后的文件名
    -z：打包同时压缩
# 例子：
    # 1、压缩多个文件，将/home/a1.txt 和 /home/a2.txt 压缩成a.tar.gz
        tar -zcvf a.tar.gz a1.txt a2.txt
    # 2、将 /home 的文件夹 压缩成 myhome.tar.gz
        tar -zcvf myhome.tar.gz /home
    # 3、将a.tar.gz 解压到当前目录
        tar -zxvf a.tar.gz
    # 4、将myhome.tar.gz 解压到 /opt 目录下 （指定解压到的目录事先要存在，否则会）
        tar -zxvf myhome.tar.gz -C /opt/ 
```

### 任务调度
```shell
crontab [选项]
# 常用选项：
    -e：编辑crontab定时任务
    -l：查询crontab任务
    -r：删除当前用户所有的crontab任务
   
# 重启任务调度
service crond restart
```

#### cron的5个占位符说明
| 占位符 | 含义 | 范围
| -- | -- | --
第一个* | 一小时当中的第几分钟 | 0 - 59
第二个* | 一天当中的第几小时 | 0 - 23
第三个* | 一个月当作的第几天 | 1 - 31
第四个* | 一年当中的第几月 | 1 -12
第五个* | 一周当中的星期几 | 0 - 7 (0和7都代表星期日)

#### 特殊符号的说明
| 特殊符号 | 含义
| --- | ---
| * | 代表任何时间。比如第一个*就代表一小时中每分钟都执行一次的意思 
| , | 代表不连续的时间。比如"0 8,12,16 * * *"，代表在每天的8点0分，12点0分，16点0分都执行一次
| - | 代表连续的时间。比如 "0 5 * * 1-6" ，代表在周一到周五的凌晨5点0分执行命令
| */n | 代表每隔多久执行一次。比如"*/10 * * * * " ，代表每隔10分钟就执行一次

### 磁盘
```shell
# 磁盘情况查询
df -h

# 查询指定目录的磁盘占用情况
du [参数]  [/目录]  (查询指定目录的磁盘占用情况，默认为当前目录)
# 常用参数：
    -s 指定目录占用大小汇总
    -h 带计量单位
    -a 含文件
    --max-depth=1 子目录深度
    -c 列出明细的同时，增加汇总值
```

### 网路
``` shell
# 使用TELNET协议远程登录。
telnet

# 使用SSH加密协议远程登录。
ssh

# 全拼secure copy，用于不同主机之间复制文件。
scp

# 命令行下载文件。
wget

# 测试主机之间网络的连通性。
ping

# 显示和设置linux系统的路由表。
route

# 查看、配置、启用或禁用网络接口的命令。
ifconfig

# 启动网卡。
ifup

# 关闭网卡。
ifdown

# 查看网络状态。
netstat

# 查看网络状态。
ss
```

### 进程
- 在 LINUX 中，每个执行的程序（代码）都称为一个进程。每一个进程都分配一个 ID 号。
- 每一个进程，都会对应一个父进程，而这个父进程可以复制多个子进程。例如 www 服务器。
- 每个进程都可能以两种方式存在的。前台与后台，所谓前台进程就是用户目前的屏幕上可以进行操作的。后台进程则是实际在操作，但由于屏幕上无法看到的进程，通常使用后台方式执行。
- 一般系统的服务都是以后台进程的方式存在，而且都会常驻在系统中。直到关机才才结束。
```shell
# 查看进程使用的指令
ps 
# 参数：
    -a：显示当前终端的所有进程信息
    -u：以用户的格式显示进程信息
    -x：显示后台进程运行的参数
    -e 显示所有进程
    -f 全格式。

# ps -aux 的指令说明
 USER：用户名称
 PID：进程号
 %CPU：进程占用 CPU 的百分比
 %MEM：进程占用物理内存的百分比
 VSZ：进程占用的虚拟内存大小（单位：KB）
 RSS：进程占用的物理内存大小（单位：KB）
 TT：终端名称,缩写 .
 STAT：进程状态，其中 S-睡眠，s-表示该进程是会话的先导进程，N-表示进程拥有比普通优先级更低的优先级，R-正在运行，D-短期等待，Z-僵死进程，T-被跟踪或者被停止等等
 STARTED：进程的启动时间
 TIME：CPU 时间，即进程使用 CPU 的总时间
 COMMAND：启动进程所用的命令和参数，如果过长会被截断显示

# ps -ef 的格式说明
 UID：用户 ID
 PID：进程 ID
 PPID：父进程 ID
 C：CPU 用于计算执行优先级的因子。数值越大，表明进程是 CPU 密集型运算，执行优先级会降低；数值越小，表明进程是 I/O 密集型运算，执行优先级会提高
 STIME：进程启动的时间
 TTY：完整的终端名称
 TIME：CPU 时间
 CMD：启动进程所用的命令和参数

---------------------------------------
# 终止进程 
kill [选项] [进程号] （通过进程号杀死进程）
killall [进程名称] （通过进程名称杀死进程，也支持通配符，这在系统因负载过大而变得很慢时很有用）
# 常用选项：
    -9 :表示强迫进程立即停止
    
---------------------------------------
# 动态监控进程    
top [选项]
# 常用选项：
    -d 秒数：指定top命令每隔几秒更新，默认是3秒
    -i：使top不显示任何限制或者僵死的进程
    -p：通过指定监控进程ID来监控某个进程的状态
    
# 交互操作：
    P：以CPU使用率排序，默认
    M：以内存的使用率排序
    N：以PID排序
    u：查看特定用户
    k：终止指定的进程
    q：退出top模式
    
--------------------------------------
# 查看系统网络情况
netstat [选项]
# 常用选项：
    -an：按一定顺序排列输出
    -p：显示哪个进程在调用       
```

### 服务(Service)管理
服务(service) 本质就是进程，但是是运行在后台的，通常都会监听某个端口，等待其它程序的请求，比如(mysql , sshd防火墙等)，因此我们又称为守护进程
```shell
# 在 CentOS7.0 后 不再使用 service ,而是 systemctl
service [服务名] [start | stop | restart | reload | status]
```

### RPM
rpm：一种用于互联网下载包的【打包及安装工具】，它包含在某些 Linux 分发版中。它生成具有.RPM扩展名的文件。RPM 是 RedHat Package Manager（RedHat 软件包管理工具）的缩写
```shell
# 查询所安装的所有 rpm 软件包
    rpm -qa 
    rpm -qa | more [分页显示]
    rpm -qa | grep X [rpm -qa | grep firefox ]
    
# 查询软件包是否安装
    rpm -q [软件包名]

# 查询软件包信息
    rpm -qi [软件包名]

# 查询软件包中的文件(查询rpm包的文件都安装到哪里了)
    rpm -ql [软件包名]

# 查询文件所属的软件包
    rpm -qf [文件全路径名]

# 卸载rpm包
    rpm -e [RPM 包的名称] 
# 强制删除rmp包（不建议）
    rpm -e --nodeps [RPM 包的名称] 
    
# 安装rpm包
    rpm -ivh [RPM 包全路径名称]
# 参数说明:
    i=install 安装
    v=verbose 提示
    h=hash 进度条
```

### YUM
Yum 是一个 Shell 前端软件包管理器。基于 RPM 包管理，能够从指定的服务器自动下载 RPM 包并且安装，可以自动处理依赖性关系，并且一次安装所有依赖的软件包。使用 yum 的前提是可以联网。
``` shell
# 查询 yum 服务器是否有需要安装的软件
yum list |grep [软件名]

# 安装指定的 yum 包
yum install [软件名]
```
### 内置命令及其它
```shell
# 将结果格式化输出到标准输出。
printf

# 周期性的执行给定的命令，并将命令的输出以全屏方式显示。
watch

# 设置系统别名。
alias

# 取消系统别名。
unalias

# 弹出光驱。
eject

# 功能强大的网络工具。
nc

# 将标准输入转换成命令行参数。
xargs

# 调用并执行指令的命令。
exec

# 设置或者显示环境变量。
export

# 删除变量或函数。
unset

# 用于判断另外一个命令是否是内置命令。
type

# 命令行科学计算器。
bc
```

## vim相关操作指令
- 进入编辑模式：输入
    - 【 i 】，当前光标开始插入；
    - 【 a 】，当前光标下一个字符开始插入；
    - 【 o 】，当前光标行增加下一行；
- 退出编辑模式：按Esc键
- 保存并退出：输入【 :wq 】
- 不保存并强制退出：输入【 :q！ 】
- 保存不退出：输入【:w】
- 查找：非编辑模式下输入【/】查找的单词，例如:/aaa；
    - 按字母键【n】，查找下一处；
- 替换：
    - 输入【r】替换当前光标字符；
    - 输入【R】，一直替换当前光标字符；
- 替换文档中所有的aaa为bbb：输入：%s/aaa/bbb/g
- 【x】：每按一次删除光标所在位置的后面一个字符。
- 【X】：大字的X，每按一次删除光标所在位置的前面一个字符
- 【gg】:命令将光标移动到文档开头
- 【G】:命令将光标移动到文档末尾
- 【yy】：拷贝当前行，；【5yy】：拷贝当前行向下的 5 行，【p】：粘贴
- 【dd】：删除当前行； 【5dd】：删除当前行向下的 5 行 
- 【：set nu】：设置文件的行号；【:set nonu】：取消文件的行号
- 【u】：撤销操作：在一个文件中输入 "hello" ,然后又撤销这个动作，再正常模式下输入u













