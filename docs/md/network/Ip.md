# IP

- IP地址是以网络号和主机号来标示网络上的主机的，我们把网络号相同的主机称之为本地网络，网络号不相同的主机称之为远程网络主机
- 本地网络中的主机可以直接相互通信；远程网络中的主机要相互通信必须通过本地网关（Gateway）来传递转发数据。
- IP地址对应于OSI参考模型的第三层网络层，工作在网络层的路由器根据目标IP和源IP来判断是否属于同一网段，如果是不同网段，则转发数据包。
- 常见的IP地址分为IPv4与IPv6两大类，当前广泛应用的是IPv4，目前IPv4几乎耗尽，下一阶段必然会进行版本升级到IPv6；


## IP地址格式和表示
- IP地址(IPv4)由32位二进制数组成，分为4段（4个字节），每一段为8位二进制数（1个字节），中间使用英文的标点符号.隔开
- 由于二进制数太长，为了便于记忆和识别，把每一段8位二进制数转成十进制，大小为0至255。IP地址的这种表示法叫做「点分十进制表示法」。
- IP地址表示为：xxx.xxx.xxx.xxx
- 计算机的IP地址由两部分组成，一部分为网络标识，一部分为主机标识，同一网段内的计算机网络部分相同，主机部分不能同时重复出现。
- 路由器连接不同网段，负责不同网段之间的数据转发，交换机连接的是同一网段的计算机。
- 通过设置网络地址和主机地址，在互相连接的整个网络中保证每台主机的IP地址不会互相重叠，即IP地址具有了唯一性。

## IP地址分类详解
&emsp; IP地址分A、B、C、D、E五类，其中A、B、C这三类是比较常用的IP地址，D、E类为特殊地址。
![IpType](/public/network/ip/IpType.png)

## 子网掩码
### 子网掩码的概念及作用
- 通过子网掩码，才能表明一台主机所在的子网与其他子网的关系，使网络正常工作。
- 子网掩码和IP地址做与运算，分离出IP地址中的网络地址和主机地址，用于判断该IP地址是在本地网络上，还是在远程网络网上。
- 子网掩码还用于将网络进一步划分为若干子网，以避免主机过多而拥堵或过少而IP浪费。

### 子网掩码的组成
- 同IP地址一样，子网掩码是由长度为32位二进制数组成的一个地址。
- 子网掩码32位与IP地址32位相对应，IP地址如果某位是网络地址，则子网掩码为1，否则为0。
- 左边连续的1的个数代表网络号的长度，（使用时必须是连续的，理论上也可以不连续），右边连续的0的个数代表主机号的长度。举个栗子：如：11111111.11111111.11111111.00000000

### 为什么要使用子网掩码
- 两台主机要通信，首先要判断是否处于同一网段，即网络地址是否相同。
- 如果相同，那么可以把数据包直接发送到目标主机，否则就需要路由网关将数据包转发送到目的地。
- 例子：A主机要与B主机通信，A和B各自的IP地址与A主机的子网掩码进行And与运算，看得出的结果：
    - 1、结果如果相同，则说明这两台主机是处于同一个网段，这样A可以通过ARP广播发现B的MAC地址，B也可以发现A的MAC地址来实现正常通信。
    - 2、如果结果不同，ARP广播会在本地网关终结，这时候A会把发给B的数据包先发给本地网关，网关再根据B主机的IP地址来查询路由表，再将数据包继续传递转发，最终送达到目的地B。
![Mask](/public/network/ip/Mask.png)

### 子网掩码和IP地址的关系
- 子网掩码是用来判断任意两台主机的IP地址是否属于同一网络的依据
- 拿双方主机的IP地址和自己主机的子网掩码做与运算，如结果为同一网络，就可以直接通信

### 根据IP地址和子网掩码，计算网络地址
- 将IP地址与子网掩码转换成二进制数。
- 将二进制形式的 IP 地址与子网掩码做与运算。
- 将得出的结果转化为十进制，便得到网络地址。
![IpAndMaskCal](/public/network/ip/IpAndMaskCal.png)
